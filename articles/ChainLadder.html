<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>ChainLadder: Claims reserving with R • ChainLadder</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ChainLadder: Claims reserving with R">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ChainLadder</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.20</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/ChainLadder.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mages/ChainLadder/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>ChainLadder: Claims reserving with R</h1>
                        <h4 data-toc-skip class="author">Alessandro
Carrato, Fabio Concina, Markus Gesmann, Dan Murphy, Mario Wüthrich and
Wayne Zhang</h4>
            
            <h4 data-toc-skip class="date">2024-07-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mages/ChainLadder/blob/master/vignettes/ChainLadder.Rmd" class="external-link"><code>vignettes/ChainLadder.Rmd</code></a></small>
      <div class="d-none name"><code>ChainLadder.Rmd</code></div>
    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      The ChainLadder package provides various statistical methods which
      are typically used for the estimation of outstanding claims
      reserves in general insurance, including those to estimate the
      claims development results as required under Solvency II.
    </div>
    
<pre><code>To cite package 'ChainLadder' in publications use:

  Gesmann M, Murphy D, Zhang Y, Carrato A, Wuthrich M, Concina F, Dal
  Moro E (2024). _ChainLadder: Statistical Methods and Models for
  Claims Reserving in General Insurance_. R package version 0.2.20,
  &lt;https://mages.github.io/ChainLadder/&gt;.</code></pre>
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<div class="section level4">
<h4 id="claims-reserving-in-insurance">Claims reserving in insurance<a class="anchor" aria-label="anchor" href="#claims-reserving-in-insurance"></a>
</h4>
<p>The insurance industry, unlike other industries, does not sell
products as such but promises. An insurance policy is a promise by the
insurer to the policyholder to pay for future claims for an upfront
received premium.</p>
<p>As a result insurers don’t know the upfront cost for their service,
but rely on historical data analysis and judgement to predict a
sustainable price for their offering. In General Insurance (or Non-Life
Insurance, e.g. motor, property and casualty insurance) most policies
run for a period of 12 months. However, the claims payment process can
take years or even decades. Therefore often not even the delivery date
of their product is known to insurers.</p>
<p>In particular losses arising from casualty insurance can take a long
time to settle and even when the claims are acknowledged it may take
time to establish the extent of the claims settlement cost. Claims can
take years to materialize. A complex and costly example are the claims
from asbestos liabilities, particularly those in connection with
mesothelioma and lung damage arising from prolonged exposure to
asbestos. A research report by a working party of the Institute and
Faculty of Actuaries estimated that the un-discounted cost of UK
mesothelioma-related claims to the UK Insurance Market for the period
2009 to 2050 could be around £10bn, see <span class="citation">(Gravelsons et al. 2009)</span>. The cost for asbestos
related claims in the US for the worldwide insurance industry was
estimate to be around $120bn in 2002, see <span class="citation">(Michaels 2002)</span>.</p>
<p>Thus, it should come as no surprise that the biggest item on the
liability side of an insurer’s balance sheet is often the provision or
reserves for future claims payments. Those reserves can be broken down
in case reserves (or outstanding claims), which are losses already
reported to the insurance company and losses that are incurred but not
reported (IBNR) yet.</p>
<p>Historically, reserving was based on deterministic calculations with
pen and paper, combined with expert judgement. Since the 1980’s, with
the arrival of personal computer, spreadsheet software became very
popular for reserving. Spreadsheets not only reduced the calculation
time, but allowed actuaries to test different scenarios and the
sensitivity of their forecasts.</p>
<p>As the computer became more powerful, ideas of more sophisticated
models started to evolve. Changes in regulatory requirements, e.g.
Solvency II in Europe, have fostered further research and promoted the
use of stochastic and statistical techniques. In particular, for many
countries extreme percentiles of reserve deterioration over a fixed time
period have to be estimated for the purpose of capital setting.</p>
<p>Over the years several methods and models have been developed to
estimate both the level and variability of reserves for insurance
claims, see <span class="citation">(Schmidt 2017)</span> or <span class="citation">(England and Verrall 2002)</span> for an overview.</p>
<p>In practice the Mack chain-ladder and bootstrap chain-ladder models
are used by many actuaries along with stress testing / scenario analysis
and expert judgement to estimate ranges of reasonable outcomes, see the
surveys of UK actuaries in 2002, <span class="citation">(Lyons et al.
2002)</span>, and across the Lloyd’s market in 2012, <span class="citation">(Orr 2012)</span>.</p>
</div>
</div>
<div class="section level3">
<h3 id="the-chainladder-package">The ChainLadder package<a class="anchor" aria-label="anchor" href="#the-chainladder-package"></a>
</h3>
<div class="section level4">
<h4 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h4>
<p>The ChainLadder package provides various statistical methods which
are typically used for the estimation of outstanding claims reserves in
general insurance. The package started out of presentations given by
Markus Gesmann at the Stochastic Reserving Seminar at the Institute of
Actuaries in 2007 and 2008, followed by talks at Casualty Actuarial
Society (CAS) meetings joined by Dan Murphy in 2008 and Wayne Zhang in
2010.</p>
<p>Implementing reserving methods in R has several advantages. R
provides:</p>
<ul>
<li>a rich language for statistical modelling and data manipulations
allowing fast prototyping</li>
<li>a very active user base, which publishes many extensions</li>
<li>many interfaces to data bases and other applications, such as MS
Excel</li>
<li>an established framework for End User Computing, including
documentation, testing and workflows with version control systems</li>
<li>code written in plain text files, allowing effective knowledge
transfer</li>
<li>an effective way to collaborate over the internet</li>
<li>built in functions to create reproducible research reports</li>
<li>in combination with other tools such as LaTeX or RMarkdown easy to
set up automated reporting facilities</li>
<li>access to academic research, which is often first implemented in
R</li>
</ul>
</div>
<div class="section level4">
<h4 id="brief-package-overview">Brief package overview<a class="anchor" aria-label="anchor" href="#brief-package-overview"></a>
</h4>
<p>This vignette will give the reader a brief overview of the
functionality of the ChainLadder package. The functions are discussed
and explained in more detail in the respective help files and examples,
see also <span class="citation">(Gesmann 2014)</span>.</p>
<p>A set of demos is shipped with the packages and the list of demos is
available via:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/demo.html" class="external-link">demo</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"ChainLadder"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h4>
<p>You can install ChainLadder in the usual way from CRAN, e.g.:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'ChainLadder'</span><span class="op">)</span></span></code></pre></div>
<p>For more details about installing packages see <span class="citation">(R Development Core Team 2022b)</span>.</p>
</div>
</div>
<div class="section level3">
<h3 id="using-the-chainladder-package">Using the ChainLadder package<a class="anchor" aria-label="anchor" href="#using-the-chainladder-package"></a>
</h3>
<div class="section level4">
<h4 id="working-with-triangles">Working with triangles<a class="anchor" aria-label="anchor" href="#working-with-triangles"></a>
</h4>
<p>Historical insurance data is often presented in form of a triangle
structure, showing the development of claims over time for each exposure
(origin) period. An origin period could be the year the policy was
written or earned, or the loss occurrence period. Of course the origin
period doesn’t have to be yearly, e.g. quarterly or monthly origin
periods are also often used. The development period of an origin period
is also called age or lag.</p>
<p>Data on the diagonals present payments in the same calendar period.
Note, data of individual policies is usually aggregated to homogeneous
lines of business, division levels or perils.</p>
<p>Most reserving methods of the ChainLadder package expect triangles as
input data sets with development periods along the columns and the
origin period in rows. The package comes with several example triangles.
The following R command will list them all:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mages.github.io/ChainLadder/" class="external-link">ChainLadder</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"ChainLadder"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s look at one example triangle more closely. The following
triangle shows data from the Reinsurance Association of America
(RAA):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RAA</span></span></code></pre></div>
<pre><code>      dev
origin    1     2     3     4     5     6     7     8     9    10
  1981 5012  8269 10907 11805 13539 16181 18009 18608 18662 18834
  1982  106  4285  5396 10666 13782 15599 15496 16169 16704    NA
  1983 3410  8992 13873 16141 18735 22214 22863 23466    NA    NA
  1984 5655 11555 15766 21266 23425 26083 27067    NA    NA    NA
  1985 1092  9565 15836 22169 25955 26180    NA    NA    NA    NA
  1986 1513  6445 11702 12935 15852    NA    NA    NA    NA    NA
  1987  557  4020 10946 12314    NA    NA    NA    NA    NA    NA
  1988 1351  6947 13112    NA    NA    NA    NA    NA    NA    NA
  1989 3133  5395    NA    NA    NA    NA    NA    NA    NA    NA
  1990 2063    NA    NA    NA    NA    NA    NA    NA    NA    NA</code></pre>
<p>This triangle shows the known values of loss from each origin year
and of annual evaluations thereafter. For example, the known values of
loss originating from the 1988 exposure period are 1351, 6947, and 13112
as of year ends 1988, 1989, and 1990, respectively. The <em>latest
diagonal</em> – i.e., the vector 18834, 16704,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>…</mi><annotation encoding="application/x-tex">\dots</annotation></semantics></math>
2063 from the upper right to the lower left – shows the most recent
evaluation available. The column headings – 1,
2,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>…</mi><annotation encoding="application/x-tex">\dots</annotation></semantics></math>,
10 – hold the <em>ages</em> (in years) of the observations in the column
relative to the beginning of the exposure period. For example, for the
1988 origin year, the age of the 13112 value, evaluated as of
1990-12-31, is three years.</p>
<p>The objective of a reserving exercise is to forecast the future
claims development in the bottom right corner of the triangle and
potential further developments beyond development age 10. Eventually all
claims for a given origin period will be settled, but it is not always
obvious to judge how many years or even decades it will take. We speak
of long and short tail business depending on the time it takes to pay
all claims.</p>
<div class="section level5">
<h5 id="plotting-triangles">Plotting triangles<a class="anchor" aria-label="anchor" href="#plotting-triangles"></a>
</h5>
<p>The first thing you often want to do is to plot the data to get an
overview. For a data set of class <code>triangle</code> the ChainLadder
package provides default plotting methods to give a graphical overview
of the data:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">RAA</span><span class="op">/</span><span class="fl">1000</span>,  main <span class="op">=</span> <span class="st">"Claims development by origin year"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="ChainLadder_files/figure-html/RAAplot-1.png" alt="Claims development chart of the RAA triangle, with one line per origin period." width="60%"><p class="caption">
Claims development chart of the RAA triangle, with one line per origin
period.
</p>
</div>
<p>Setting the argument <code>lattice=TRUE</code> will produce
individual plots for each origin period.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">RAA</span><span class="op">/</span><span class="fl">1000</span>, lattice<span class="op">=</span><span class="cn">TRUE</span>, main <span class="op">=</span> <span class="st">"Claims development by origin year"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="ChainLadder_files/figure-html/RAAplot2-1.png" alt="Claims development chart of the RAA triangle, with individual panels for each origin period" width="60%"><p class="caption">
Claims development chart of the RAA triangle, with individual panels for
each origin period
</p>
</div>
<p>You will notice from the plots that the triangle <code>RAA</code>
presents claims developments for the origin years 1981 to 1990 in a
cumulative form. For more information on the triangle plotting functions
see the help pages of <code>plot.triangle</code>.</p>
</div>
</div>
<div class="section level4">
<h4 id="transforming-triangles-between-cumulative-and-incremental-representation">Transforming triangles between cumulative and incremental
representation<a class="anchor" aria-label="anchor" href="#transforming-triangles-between-cumulative-and-incremental-representation"></a>
</h4>
<p>The ChainLadder packages comes with two helper functions,
<code>cum2incr</code> and <code>incr2cum</code> to transform cumulative
triangles into incremental triangles and vice versa:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raa.inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/utilityfunctions.html">cum2incr</a></span><span class="op">(</span><span class="va">RAA</span><span class="op">)</span></span>
<span><span class="co">## Show first origin period and its incremental development</span></span>
<span><span class="va">raa.inc</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span></code></pre></div>
<pre><code>   1    2    3    4    5    6    7    8    9   10 
5012 3257 2638  898 1734 2642 1828  599   54  172 </code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raa.cum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/utilityfunctions.html">incr2cum</a></span><span class="op">(</span><span class="va">raa.inc</span><span class="op">)</span></span>
<span><span class="co">## Show first origin period and its cumulative development</span></span>
<span><span class="va">raa.cum</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span></code></pre></div>
<pre><code>    1     2     3     4     5     6     7     8     9    10 
 5012  8269 10907 11805 13539 16181 18009 18608 18662 18834 </code></pre>
<div class="section level5">
<h5 id="importing-triangles-from-external-data-sources">Importing triangles from external data sources<a class="anchor" aria-label="anchor" href="#importing-triangles-from-external-data-sources"></a>
</h5>
<p>In most cases you want to analyse your own data, usually stored in
data bases or spreadsheets.</p>
<div class="section level6">
<h6 id="importing-a-triangle-from-a-spreadsheet">Importing a triangle from a spreadsheet<a class="anchor" aria-label="anchor" href="#importing-a-triangle-from-a-spreadsheet"></a>
</h6>
<p>There are many ways to import the data from a spreadsheet. A quick
and dirty solution is using a CSV-file.</p>
<p>Open a new workbook and copy your triangle into cell A1, with the
first column being the accident or origin period and the first row
describing the development period or age.</p>
<p>Ensure the triangle has no formatting, such a commas to separate
thousands, as those cells will be saved as characters.</p>
<div class="figure" style="text-align: center">
<img src="SpreadsheetTriangle.png" alt="Screen shot of a triangle in a spreadsheet software." width="60%"><p class="caption">
Screen shot of a triangle in a spreadsheet software.
</p>
</div>
<p>Now open R and go through the following commands:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myCSVfile</span> <span class="op">&lt;-</span> <span class="st">"path/to/folder/with/triangle.csv"</span></span>
<span><span class="co">## Use the R command:</span></span>
<span><span class="co"># myCSVfile &lt;- file.choose() to select the file interactively</span></span>
<span><span class="va">tri</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file<span class="op">=</span><span class="va">myCSVfile</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">## Use read.csv2 if semicolons are used as a separator likely</span></span>
<span><span class="co">## to be the case if you are in continental Europe</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mages.github.io/ChainLadder/" class="external-link">ChainLadder</a></span><span class="op">)</span></span>
<span><span class="co">## Convert to triangle</span></span>
<span><span class="va">tri</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Triangles.html">as.triangle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">tri</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Job done.</span></span></code></pre></div>
<p>Small data sets can be transferred to R backwards and forwards via
the clipboard under MS Windows.</p>
<p>Select a data set in the spreadsheet and copy it into the clipboard,
then go to R and type:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tri</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"clipboard"</span>, sep<span class="op">=</span><span class="st">"\t"</span>, na.strings<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level6">
<h6 id="reading-data-from-a-data-base">Reading data from a data base<a class="anchor" aria-label="anchor" href="#reading-data-from-a-data-base"></a>
</h6>
<p>R makes it easy to access data using SQL statements, e.g. via an ODBC
connection<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;See the &lt;code&gt;RODBC&lt;/code&gt; and &lt;code&gt;DBI&lt;/code&gt;
packages&lt;/p&gt;"><sup>1</sup></a>, for more details see <span class="citation">(R Development Core Team 2022a)</span>. The ChainLadder
packages includes a demo to showcase how data can be imported from a MS
Access data base, see:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/demo.html" class="external-link">demo</a></span><span class="op">(</span><span class="va">DatabaseExamples</span><span class="op">)</span></span></code></pre></div>
<p>In this section we use data stored in a CSV-file<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Please ensure that your CSV-file is free from
formatting, e.g. characters to separate units of thousands, as those
columns will be read as characters or factors rather than numerical
values.&lt;/p&gt;"><sup>2</sup></a> to demonstrate some
typical operations you will want to carry out with data stored in data
bases. CSV stands for comma separated values, stored in a text file.
Note many European countries use a comma as decimal point and a
semicolon as field separator, see also the help file to
<code>read.csv2</code>. In most cases your triangles will be stored in
tables and not in a classical triangle shape. The ChainLadder package
contains a CSV-file with sample data in a long table format. We read the
data into R’s memory with the <code>read.csv</code> command and look at
the first couple of rows and summarise it:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filename</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"Database"</span>,</span>
<span>                                   package<span class="op">=</span><span class="st">"ChainLadder"</span><span class="op">)</span>,</span>
<span>                       <span class="st">"TestData.csv"</span><span class="op">)</span></span>
<span><span class="va">myData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">filename</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">myData</span><span class="op">)</span></span></code></pre></div>
<pre><code>  origin dev  value lob
1   1977   1 153638 ABC
2   1978   1 178536 ABC
3   1979   1 210172 ABC
4   1980   1 211448 ABC
5   1981   1 219810 ABC
6   1982   1 205654 ABC</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">myData</span><span class="op">)</span></span></code></pre></div>
<pre><code>     origin          dev            value             lob           
 Min.   :   1   Min.   : 1.00   Min.   : -17657   Length:701        
 1st Qu.:   3   1st Qu.: 2.00   1st Qu.:  10324   Class :character  
 Median :   6   Median : 4.00   Median :  72468   Mode  :character  
 Mean   : 642   Mean   : 4.61   Mean   : 176632                     
 3rd Qu.:1979   3rd Qu.: 7.00   3rd Qu.: 197716                     
 Max.   :1991   Max.   :14.00   Max.   :3258646                     </code></pre>
<p>Let’s focus on one subset of the data. We select the RAA data
again:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">myData</span>, <span class="va">lob</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"RAA"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">raa</span><span class="op">)</span></span></code></pre></div>
<pre><code>   origin dev value lob
67   1981   1  5012 RAA
68   1982   1   106 RAA
69   1983   1  3410 RAA
70   1984   1  5655 RAA
71   1985   1  1092 RAA
72   1986   1  1513 RAA</code></pre>
<p>To transform the long table of the RAA data into a triangle we use
the function <code>as.triangle</code>. The arguments we have to specify
are the column names of the origin and development period and further
the column which contains the values:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raa.tri</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Triangles.html">as.triangle</a></span><span class="op">(</span><span class="va">raa</span>,</span>
<span>                       origin<span class="op">=</span><span class="st">"origin"</span>,</span>
<span>                       dev<span class="op">=</span><span class="st">"dev"</span>,</span>
<span>                       value<span class="op">=</span><span class="st">"value"</span><span class="op">)</span></span>
<span><span class="va">raa.tri</span></span></code></pre></div>
<pre><code>      dev
origin    1    2    3    4    5    6    7   8   9  10
  1981 5012 3257 2638  898 1734 2642 1828 599  54 172
  1982  106 4179 1111 5270 3116 1817 -103 673 535  NA
  1983 3410 5582 4881 2268 2594 3479  649 603  NA  NA
  1984 5655 5900 4211 5500 2159 2658  984  NA  NA  NA
  1985 1092 8473 6271 6333 3786  225   NA  NA  NA  NA
  1986 1513 4932 5257 1233 2917   NA   NA  NA  NA  NA
  1987  557 3463 6926 1368   NA   NA   NA  NA  NA  NA
  1988 1351 5596 6165   NA   NA   NA   NA  NA  NA  NA
  1989 3133 2262   NA   NA   NA   NA   NA  NA  NA  NA
  1990 2063   NA   NA   NA   NA   NA   NA  NA  NA  NA</code></pre>
<p>We note that the data has been stored as an incremental data set. As
mentioned above, we could now use the function <code>incr2cum</code> to
transform the triangle into a cumulative format.</p>
<p>We can transform a triangle back into a data frame structure:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raa.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">raa.tri</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">raa.df</span><span class="op">)</span></span></code></pre></div>
<pre><code>       origin dev value
1981-1   1981   1  5012
1982-1   1982   1   106
1983-1   1983   1  3410
1984-1   1984   1  5655
1985-1   1985   1  1092
1986-1   1986   1  1513</code></pre>
<p>This is particularly helpful when you would like to store your
results back into a data base. The following figure gives you an idea of
a potential data flow between R and data bases.</p>
<div class="figure" style="text-align: center">
<img src="RandDatabases.png" alt="Flow chart of data between R and data bases" width="60%"><p class="caption">
Flow chart of data between R and data bases
</p>
</div>
</div>
</div>
<div class="section level5">
<h5 id="creating-triangles-interactively">Creating triangles interactively<a class="anchor" aria-label="anchor" href="#creating-triangles-interactively"></a>
</h5>
<p>For small data sets or while testing procedures, it may be useful to
create triangles interactively from the command line. There are two main
ways to proceed. With the first we create a matrix of data (including
missing values in the lower right portion of the triangle) and then
convert it into a triangle with <code>as.triangle</code>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Triangles.html">as.triangle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">150</span>, <span class="fl">175</span>, <span class="fl">180</span>, <span class="fl">200</span>,</span>
<span>                     <span class="fl">110</span>, <span class="fl">168</span>, <span class="fl">192</span>, <span class="fl">205</span>, <span class="cn">NA</span>,</span>
<span>                     <span class="fl">115</span>, <span class="fl">169</span>, <span class="fl">202</span>, <span class="cn">NA</span>,  <span class="cn">NA</span>,</span>
<span>                     <span class="fl">125</span>, <span class="fl">185</span>, <span class="cn">NA</span>,  <span class="cn">NA</span>,  <span class="cn">NA</span>,</span>
<span>                     <span class="fl">150</span>, <span class="cn">NA</span>,  <span class="cn">NA</span>,  <span class="cn">NA</span>,  <span class="cn">NA</span><span class="op">)</span>,</span>
<span>                   nrow <span class="op">=</span> <span class="fl">5</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>      dev
origin   1   2   3   4   5
     1 100 150 175 180 200
     2 110 168 192 205  NA
     3 115 169 202  NA  NA
     4 125 185  NA  NA  NA
     5 150  NA  NA  NA  NA</code></pre>
<p>We may also create the triangle directly with <code>triangle</code>
by providing the rows (or columns) of <em>known</em> data as vectors,
thereby omitting the missing values:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Triangles.html">triangle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">150</span>, <span class="fl">175</span>, <span class="fl">180</span>, <span class="fl">200</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">110</span>, <span class="fl">168</span>, <span class="fl">192</span>, <span class="fl">205</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">115</span>, <span class="fl">169</span>, <span class="fl">202</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">125</span>, <span class="fl">185</span><span class="op">)</span>,</span>
<span>         <span class="fl">150</span><span class="op">)</span></span></code></pre></div>
<pre><code>      dev
origin   1   2   3   4   5
     1 100 150 175 180 200
     2 110 168 192 205  NA
     3 115 169 202  NA  NA
     4 125 185  NA  NA  NA
     5 150  NA  NA  NA  NA</code></pre>
</div>
</div>
</div>
<div class="section level3">
<h3 id="chain-ladder-methods">Chain-ladder methods<a class="anchor" aria-label="anchor" href="#chain-ladder-methods"></a>
</h3>
<p>The classical chain-ladder is a deterministic algorithm to forecast
claims based on historical data. It assumes that the proportional
developments of claims from one development period to the next are the
same for all origin years.</p>
<div class="section level4">
<h4 id="basic-idea">Basic idea<a class="anchor" aria-label="anchor" href="#basic-idea"></a>
</h4>
<p>Most commonly as a first step, the age-to-age link ratios are
calculated as the volume weighted average development ratios of a
cumulative loss development triangle from one development period to the
next
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>,</mo><mi>i</mi><mo>,</mo><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">C_{ik}, i,k =1, \dots, n</annotation></semantics></math>.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>f</mi><mi>k</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>−</mo><mi>k</mi></mrow></munderover><msub><mi>C</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>−</mo><mi>k</mi></mrow></munderover><msub><mi>C</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub></mrow></mfrac></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  f_{k} &amp;= \frac{\sum_{i=1}^{n-k} C_{i,k+1}}{\sum_{i=1}^{n-k}C_{i,k}}
\end{aligned}
</annotation></semantics></math></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate age-to-age factors for RAA triangle</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>            <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">RAA</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="va">i</span><span class="op">)</span><span class="op">)</span>,<span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">RAA</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="va">i</span><span class="op">)</span><span class="op">)</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>            <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="va">f</span></span></code></pre></div>
<pre><code>[1] 2.999 1.624 1.271 1.172 1.113 1.042 1.033 1.017 1.009</code></pre>
<p>Often it is not suitable to assume that the oldest origin year is
fully developed. A typical approach is to extrapolate the development
ratios, e.g. assuming a linear model on a log scale.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dev.period</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">f</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">~</span> <span class="va">dev.period</span>, </span>
<span>     main<span class="op">=</span><span class="st">"Log-linear extrapolation of age-to-age factors"</span><span class="op">)</span></span>
<span><span class="va">tail.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">f</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">~</span> <span class="va">dev.period</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">tail.model</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChainLadder_files/figure-html/unnamed-chunk-16-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">co</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">tail.model</span><span class="op">)</span></span>
<span><span class="co">## extrapolate another 100 dev. period</span></span>
<span><span class="va">tail</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">co</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">+</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">co</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="va">f.tail</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="va">tail</span><span class="op">)</span></span>
<span><span class="va">f.tail</span></span></code></pre></div>
<pre><code>[1] 1.009</code></pre>
<p>The age-to-age factors allow us to plot the expected claims
development patterns.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumprod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">f</span>, <span class="va">tail</span><span class="op">[</span><span class="va">tail</span><span class="op">&gt;</span><span class="fl">1.0001</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, t<span class="op">=</span><span class="st">"b"</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Expected claims development pattern"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Dev. period"</span>, ylab<span class="op">=</span><span class="st">"Development % of ultimate loss"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChainLadder_files/figure-html/unnamed-chunk-17-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>The link ratios are then applied to the latest known cumulative
claims amount to forecast the next development period. The
<em>squaring</em> of the RAA triangle is calculated below, where an
<em>ultimate</em> column is appended to the right to accommodate the
expected development beyond the oldest age (10) of the triangle due to
the tail factor (1.009) being greater than unity.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">f</span>, <span class="va">f.tail</span><span class="op">)</span></span>
<span><span class="va">fullRAA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">RAA</span>, Ult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">fullRAA</span><span class="op">[</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fullRAA</span><span class="op">[</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>,<span class="va">k</span><span class="op">]</span><span class="op">*</span><span class="va">f</span><span class="op">[</span><span class="va">k</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fullRAA</span><span class="op">)</span></span></code></pre></div>
<pre><code>        1     2     3     4     5     6     7     8     9    10   Ult
1981 5012  8269 10907 11805 13539 16181 18009 18608 18662 18834 19012
1982  106  4285  5396 10666 13782 15599 15496 16169 16704 16858 17017
1983 3410  8992 13873 16141 18735 22214 22863 23466 23863 24083 24311
1984 5655 11555 15766 21266 23425 26083 27067 27967 28441 28703 28974
1985 1092  9565 15836 22169 25955 26180 27278 28185 28663 28927 29200
1986 1513  6445 11702 12935 15852 17649 18389 19001 19323 19501 19685
1987  557  4020 10946 12314 14428 16064 16738 17294 17587 17749 17917
1988 1351  6947 13112 16664 19525 21738 22650 23403 23800 24019 24246
1989 3133  5395  8759 11132 13043 14521 15130 15634 15898 16045 16196
1990 2063  6188 10046 12767 14959 16655 17353 17931 18234 18402 18576</code></pre>
<p>The total estimated outstanding loss under this method is about
54100:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fullRAA</span><span class="op">[</span> ,<span class="fl">11</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="../reference/getLatestCumulative.html">getLatestCumulative</a></span><span class="op">(</span><span class="va">RAA</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 54146</code></pre>
<p>This approach is also called Loss Development Factor (LDF)
method.</p>
<p>More generally, the factors used to square the triangle need not
always be drawn from the dollar weighted averages of the triangle. Other
sources of factors from which the actuary may <em>select</em> link
ratios include simple averages from the triangle, averages weighted
toward more recent observations or adjusted for outliers, and benchmark
patterns based on related, more credible loss experience. Also, since
the ultimate value of claims is simply the product of the most current
diagonal and the cumulative product of the link ratios, the completion
of interior of the triangle is usually not displayed in favor of that
multiplicative calculation.</p>
<p>For example, suppose the actuary decides that the volume weighted
factors from the RAA triangle are representative of expected future
growth, but discards the 1.009 tail factor derived from the loglinear
fit in favor of a five percent tail (1.05) based on loss data from a
larger book of similar business. The LDF method might be displayed in R
as follows.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linkratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="fu"><a href="../reference/ata.html">ata</a></span><span class="op">(</span><span class="va">RAA</span><span class="op">)</span>, <span class="st">"vwtd"</span><span class="op">)</span>, tail <span class="op">=</span> <span class="fl">1.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">linkratios</span>, <span class="fl">3</span><span class="op">)</span> <span class="co"># display to only three decimal places</span></span></code></pre></div>
<pre><code>  1-2   2-3   3-4   4-5   5-6   6-7   7-8   8-9  9-10  tail 
2.999 1.624 1.271 1.172 1.113 1.042 1.033 1.017 1.009 1.050 </code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">LDF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumprod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">linkratios</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">LDF</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">RAA</span><span class="op">)</span> <span class="co"># so the display matches the triangle</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">LDF</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>    1     2     3     4     5     6     7     8     9    10 
9.366 3.123 1.923 1.513 1.292 1.160 1.113 1.078 1.060 1.050 </code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">currentEval</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getLatestCumulative.html">getLatestCumulative</a></span><span class="op">(</span><span class="va">RAA</span><span class="op">)</span></span>
<span><span class="co"># Reverse the LDFs so the first, least mature factor [1]</span></span>
<span><span class="co">#   is applied to the last origin year (1990)</span></span>
<span><span class="va">EstdUlt</span> <span class="op">&lt;-</span> <span class="va">currentEval</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">LDF</span><span class="op">)</span> <span class="co">#</span></span>
<span><span class="co"># Start with the body of the exhibit</span></span>
<span><span class="va">Exhibit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">currentEval</span>, LDF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">LDF</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="va">EstdUlt</span><span class="op">)</span></span>
<span><span class="co"># Tack on a Total row</span></span>
<span><span class="va">Exhibit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">Exhibit</span>,</span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>currentEval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">currentEval</span><span class="op">)</span>, LDF<span class="op">=</span><span class="cn">NA</span>, EstdUlt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">EstdUlt</span><span class="op">)</span>,</span>
<span>           row.names <span class="op">=</span> <span class="st">"Total"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Exhibit</span></span></code></pre></div>
<pre><code>      currentEval   LDF EstdUlt
1981        18834 1.050   19776
1982        16704 1.060   17701
1983        23466 1.078   25288
1984        27067 1.113   30138
1985        26180 1.160   30373
1986        15852 1.292   20476
1987        12314 1.513   18637
1988        13112 1.923   25220
1989         5395 3.123   16847
1990         2063 9.366   19323
Total      160987    NA  223778</code></pre>
<p>Since the early 1990s several papers have been published to embed the
simple chain-ladder method into a statistical framework. Ben Zehnwirth
and Glenn Barnett point out in <span class="citation">(Zehnwirth and
Barnett 2000)</span> that the age-to-age link ratios can be regarded as
the coefficients of a weighted linear regression through the origin, see
also <span class="citation">(Murphy 1994)</span>.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lmCL</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span>, <span class="va">Triangle</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="fl">0</span>, weights<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="va">Triangle</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>,</span>
<span>     data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Triangle</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, y<span class="op">=</span><span class="va">Triangle</span><span class="op">[</span>,<span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="va">lmCL</span>, <span class="va">RAA</span><span class="op">)</span>, <span class="va">coef</span><span class="op">)</span></span></code></pre></div>
<pre><code>    x     x     x     x     x     x     x     x     x 
2.999 1.624 1.271 1.172 1.113 1.042 1.033 1.017 1.009 </code></pre>
</div>
<div class="section level4">
<h4 id="mack-chain-ladder">Mack chain-ladder<a class="anchor" aria-label="anchor" href="#mack-chain-ladder"></a>
</h4>
<p>Thomas Mack published in 1993 <span class="citation">(Mack
1993)</span> a method which estimates the standard errors of the
chain-ladder forecast without assuming a distribution under three
conditions.</p>
<p>Following the notation of Mack <span class="citation">(Mack
1999)</span> let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">C_{ik}</annotation></semantics></math>
denote the cumulative loss amounts of origin period (e.g. accident year)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">i=1,\ldots,m</annotation></semantics></math>,
with losses known for development period (e.g. development year)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>≤</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo>−</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">k \le n+1-i</annotation></semantics></math>.</p>
<p>In order to forecast the amounts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">C_{ik}</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&gt;</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo>−</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">k &gt; n+1-i</annotation></semantics></math>
the Mack chain-ladder-model assumes:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mrow><mtext mathvariant="normal">CL1: </mtext><mspace width="0.333em"></mspace></mrow></mtd><mtd columnalign="left" style="text-align: left"><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>F</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>C</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>C</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>C</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msub><mi>f</mi><mi>k</mi></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> with </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>F</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>=</mo><mfrac><msub><mi>C</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><msub><mi>C</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mtext mathvariant="normal">CL2: </mtext><mspace width="0.333em"></mspace></mrow></mtd><mtd columnalign="left" style="text-align: left"><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>C</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><msub><mi>C</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub></mfrac><mo stretchy="false" form="prefix">|</mo><msub><mi>C</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>C</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>C</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msubsup><mi>σ</mi><mi>k</mi><mn>2</mn></msubsup><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><msubsup><mi>C</mi><mrow><mi>i</mi><mi>k</mi></mrow><mi>α</mi></msubsup></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mtext mathvariant="normal">CL3: </mtext><mspace width="0.333em"></mspace></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo stretchy="false" form="prefix">{</mo><msub><mi>C</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>C</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy="false" form="postfix">}</mo><mo>,</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>C</mi><mrow><mi>j</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>C</mi><mrow><mi>j</mi><mi>n</mi></mrow></msub><mo stretchy="false" form="postfix">}</mo><mo>,</mo><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> are independent for origin period </mtext><mspace width="0.333em"></mspace></mrow><mi>i</mi><mo>≠</mo><mi>j</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \mbox{CL1: }  &amp; E[ F_{ik}| C_{i1},C_{i2},\ldots,C_{ik} ] = f_k
  \mbox{ with } F_{ik}=\frac{C_{i,k+1}}{C_{ik}}\\
    \mbox{CL2: } &amp;  Var( \frac{C_{i,k+1}}{C_{ik}} | C_{i1},C_{i2},
    \ldots,C_{ik} ) = \frac{\sigma_k^2}{w_{ik} C^\alpha_{ik}}\\
  \mbox{CL3: } &amp; \{C_{i1},\ldots,C_{in}\}, \{
    C_{j1},\ldots,C_{jn}\},\mbox{ are independent for origin period } i
    \neq j
\end{aligned}
</annotation></semantics></math></p>
<p>with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>;</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mi>α</mi><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">w_{ik} \in [0;1], \alpha \in \{0,1,2\}</annotation></semantics></math>.
If these assumptions hold, the Mack chain-ladder-model gives an unbiased
estimator for IBNR (Incurred But Not Reported) claims.</p>
<p>The Mack chain-ladder model can be regarded as a weighted linear
regression through the origin for each development period:
<code>lm(y ~ x  + 0, weights=w/x^(2-alpha))</code>, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
is the vector of claims at development period
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k+1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
is the vector of claims at development period
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</p>
<p>The Mack method is implemented in the ChainLadder package via the
function <code>MackChainLadder</code>.</p>
<p>As an example we apply the <code>MackChainLadder</code> function to
our triangle <code>RAA</code>:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mack</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MackChainLadder.html">MackChainLadder</a></span><span class="op">(</span><span class="va">RAA</span>, est.sigma<span class="op">=</span><span class="st">"Mack"</span><span class="op">)</span></span>
<span><span class="va">mack</span> <span class="co"># same as summary(mack) </span></span></code></pre></div>
<pre><code>MackChainLadder(Triangle = RAA, est.sigma = "Mack")

     Latest Dev.To.Date Ultimate   IBNR Mack.S.E CV(IBNR)
1981 18,834       1.000   18,834      0        0      NaN
1982 16,704       0.991   16,858    154      206    1.339
1983 23,466       0.974   24,083    617      623    1.010
1984 27,067       0.943   28,703  1,636      747    0.457
1985 26,180       0.905   28,927  2,747    1,469    0.535
1986 15,852       0.813   19,501  3,649    2,002    0.549
1987 12,314       0.694   17,749  5,435    2,209    0.406
1988 13,112       0.546   24,019 10,907    5,358    0.491
1989  5,395       0.336   16,045 10,650    6,333    0.595
1990  2,063       0.112   18,402 16,339   24,566    1.503

              Totals
Latest:   160,987.00
Dev:            0.76
Ultimate: 213,122.23
IBNR:      52,135.23
Mack.S.E   26,909.01
CV(IBNR):       0.52</code></pre>
<p>We can access the loss development factors and the full triangle
via:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mack</span><span class="op">$</span><span class="va">f</span></span></code></pre></div>
<pre><code> [1] 2.999 1.624 1.271 1.172 1.113 1.042 1.033 1.017 1.009 1.000</code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mack</span><span class="op">$</span><span class="va">FullTriangle</span></span></code></pre></div>
<pre><code>      dev
origin    1     2     3     4     5     6     7     8     9    10
  1981 5012  8269 10907 11805 13539 16181 18009 18608 18662 18834
  1982  106  4285  5396 10666 13782 15599 15496 16169 16704 16858
  1983 3410  8992 13873 16141 18735 22214 22863 23466 23863 24083
  1984 5655 11555 15766 21266 23425 26083 27067 27967 28441 28703
  1985 1092  9565 15836 22169 25955 26180 27278 28185 28663 28927
  1986 1513  6445 11702 12935 15852 17649 18389 19001 19323 19501
  1987  557  4020 10946 12314 14428 16064 16738 17294 17587 17749
  1988 1351  6947 13112 16664 19525 21738 22650 23403 23800 24019
  1989 3133  5395  8759 11132 13043 14521 15130 15634 15898 16045
  1990 2063  6188 10046 12767 14959 16655 17353 17931 18234 18402</code></pre>
<p>If you are only interested in the summary statistics then use:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mack_smmry</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mack</span><span class="op">)</span> <span class="co"># See also ?summary.MackChainLadder</span></span>
<span><span class="va">mack_smmry</span><span class="op">$</span><span class="va">ByOrigin</span></span></code></pre></div>
<pre><code>     Latest Dev.To.Date Ultimate    IBNR Mack.S.E CV(IBNR)
1981  18834      1.0000    18834     0.0      0.0      NaN
1982  16704      0.9909    16858   154.0    206.2   1.3395
1983  23466      0.9744    24083   617.4    623.4   1.0097
1984  27067      0.9430    28703  1636.1    747.2   0.4567
1985  26180      0.9050    28927  2746.7   1469.5   0.5350
1986  15852      0.8129    19501  3649.1   2001.9   0.5486
1987  12314      0.6938    17749  5435.3   2209.2   0.4065
1988  13112      0.5459    24019 10907.2   5357.9   0.4912
1989   5395      0.3362    16045 10650.0   6333.2   0.5947
1990   2063      0.1121    18402 16339.4  24566.3   1.5035</code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mack_smmry</span><span class="op">$</span><span class="va">Totals</span></span></code></pre></div>
<pre><code>              Totals
Latest:    1.610e+05
Dev:       7.554e-01
Ultimate:  2.131e+05
IBNR:      5.214e+04
Mack S.E.: 2.691e+04
CV(IBNR):  5.161e-01</code></pre>
<p>To check that Mack’s assumption are valid review the residual plots,
you should see no trends in either of them.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mack</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="ChainLadder_files/figure-html/MackPlot1-1.png" alt="Some residual show clear trends, indicating that the Mack assumptions are not well met" width="60%"><p class="caption">
Some residual show clear trends, indicating that the Mack assumptions
are not well met
</p>
</div>
<p>We can plot the development, including the forecast and estimated
standard errors by origin period by setting the argument
<code>lattice=TRUE</code>.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mack</span>, lattice<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChainLadder_files/figure-html/MackPlot2-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="section level5">
<h5 id="using-a-subset-of-the-triangle">Using a subset of the triangle<a class="anchor" aria-label="anchor" href="#using-a-subset-of-the-triangle"></a>
</h5>
<p>The <code>weights</code> argument allows for the selection of a
subset of the triangle for the projections.</p>
<p>For example, in order to use only the last 5 calendar years of the
triangle, set the <code>weights</code> as follows:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calPeriods</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.html" class="external-link">row</a></span><span class="op">(</span><span class="va">RAA</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/col.html" class="external-link">col</a></span><span class="op">(</span><span class="va">RAA</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">calPeriods</span> <span class="op">&lt;=</span> <span class="fl">5</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">calPeriods</span> <span class="op">&gt;</span> <span class="fl">10</span>, <span class="cn">NA</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
 [1,]    0    0    0    0    0    1    1    1    1     1
 [2,]    0    0    0    0    1    1    1    1    1    NA
 [3,]    0    0    0    1    1    1    1    1   NA    NA
 [4,]    0    0    1    1    1    1    1   NA   NA    NA
 [5,]    0    1    1    1    1    1   NA   NA   NA    NA
 [6,]    1    1    1    1    1   NA   NA   NA   NA    NA
 [7,]    1    1    1    1   NA   NA   NA   NA   NA    NA
 [8,]    1    1    1   NA   NA   NA   NA   NA   NA    NA
 [9,]    1    1   NA   NA   NA   NA   NA   NA   NA    NA
[10,]    1   NA   NA   NA   NA   NA   NA   NA   NA    NA</code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MackChainLadder.html">MackChainLadder</a></span><span class="op">(</span><span class="va">RAA</span>, weights<span class="op">=</span><span class="va">weights</span>, est.sigma <span class="op">=</span> <span class="st">"Mack"</span><span class="op">)</span></span></code></pre></div>
<pre><code>MackChainLadder(Triangle = RAA, weights = weights, est.sigma = "Mack")

     Latest Dev.To.Date Ultimate   IBNR Mack.S.E CV(IBNR)
1981 18,834      1.0000   18,834      0        0      NaN
1982 16,704      0.9909   16,858    154      206    1.339
1983 23,466      0.9744   24,083    617      623    1.010
1984 27,067      0.9430   28,703  1,636      747    0.457
1985 26,180      0.9050   28,927  2,747    1,469    0.535
1986 15,852      0.8229   19,264  3,412    2,039    0.598
1987 12,314      0.7106   17,329  5,015    2,144    0.428
1988 13,112      0.5613   23,361 10,249    4,043    0.395
1989  5,395      0.2935   18,384 12,989    5,931    0.457
1990  2,063      0.0843   24,463 22,400   16,779    0.749

              Totals
Latest:   160,987.00
Dev:            0.73
Ultimate: 220,207.63
IBNR:      59,220.63
Mack.S.E   19,859.00
CV(IBNR):       0.34</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="munich-chain-ladder">Munich chain-ladder<a class="anchor" aria-label="anchor" href="#munich-chain-ladder"></a>
</h4>
<p>Munich chain-ladder is a reserving method that reduces the gap
between IBNR projections based on paid losses and IBNR projections based
on incurred losses. The Munich chain-ladder method uses correlations
between paid and incurred losses of the historical data into the
projection for the future <span class="citation">(Quarg and Mack
2004)</span>.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MCLpaid</span></span></code></pre></div>
<pre><code>      dev
origin    1    2    3    4    5    6    7
     1  576 1804 1970 2024 2074 2102 2131
     2  866 1948 2162 2232 2284 2348   NA
     3 1412 3758 4252 4416 4494   NA   NA
     4 2286 5292 5724 5850   NA   NA   NA
     5 1868 3778 4648   NA   NA   NA   NA
     6 1442 4010   NA   NA   NA   NA   NA
     7 2044   NA   NA   NA   NA   NA   NA</code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MCLincurred</span></span></code></pre></div>
<pre><code>      dev
origin    1    2    3    4    5    6    7
     1  978 2104 2134 2144 2174 2182 2174
     2 1844 2552 2466 2480 2508 2454   NA
     3 2904 4354 4698 4600 4644   NA   NA
     4 3502 5958 6070 6142   NA   NA   NA
     5 2812 4882 4852   NA   NA   NA   NA
     6 2642 4406   NA   NA   NA   NA   NA
     7 5022   NA   NA   NA   NA   NA   NA</code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MCLpaid</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MCLincurred</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChainLadder_files/figure-html/unnamed-chunk-26-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Following the example in Quarg's (2004) paper:</span></span>
<span><span class="va">MCL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MunichChainLadder.html">MunichChainLadder</a></span><span class="op">(</span><span class="va">MCLpaid</span>, <span class="va">MCLincurred</span>, est.sigmaP<span class="op">=</span><span class="fl">0.1</span>, est.sigmaI<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">MCL</span></span></code></pre></div>
<pre><code>MunichChainLadder(Paid = MCLpaid, Incurred = MCLincurred, est.sigmaP = 0.1, 
    est.sigmaI = 0.1)

  Latest Paid Latest Incurred Latest P/I Ratio Ult. Paid Ult. Incurred
1       2,131           2,174            0.980     2,131         2,174
2       2,348           2,454            0.957     2,383         2,444
3       4,494           4,644            0.968     4,597         4,629
4       5,850           6,142            0.952     6,119         6,176
5       4,648           4,852            0.958     4,937         4,950
6       4,010           4,406            0.910     4,656         4,665
7       2,044           5,022            0.407     7,549         7,650
  Ult. P/I Ratio
1          0.980
2          0.975
3          0.993
4          0.991
5          0.997
6          0.998
7          0.987

Totals
            Paid Incurred P/I Ratio
Latest:   25,525   29,694      0.86
Ultimate: 32,371   32,688      0.99</code></pre>
<p>You can use <code>summary(MCL)$ByOrigin</code> and
<code>summary(MCL)$Totals</code> to extract the information from the
output above.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MCL</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChainLadder_files/figure-html/unnamed-chunk-28-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="bootstrap-chain-ladder">Bootstrap chain-ladder<a class="anchor" aria-label="anchor" href="#bootstrap-chain-ladder"></a>
</h4>
<p>The <code>BootChainLadder</code> function uses a two-stage
bootstrapping/simulation approach following the paper by England and
Verrall <span class="citation">(England and Verrall 2002)</span>. In the
first stage an ordinary chain-ladder methods is applied to the
cumulative claims triangle. From this we calculate the scaled Pearson
residuals which we bootstrap R times to forecast future incremental
claims payments via the standard chain-ladder method. In the second
stage we simulate the process error with the bootstrap value as the mean
and using the process distribution assumed. The set of reserves obtained
in this way forms the predictive distribution, from which summary
statistics such as mean, prediction error or quantiles can be
derived.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## See also the example in section 8 of England &amp; Verrall (2002)</span></span>
<span><span class="co">## on page 55.</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BootChainLadder.html">BootChainLadder</a></span><span class="op">(</span><span class="va">RAA</span>, R<span class="op">=</span><span class="fl">999</span>, process.distr<span class="op">=</span><span class="st">"gamma"</span><span class="op">)</span></span>
<span><span class="va">B</span></span></code></pre></div>
<pre><code>BootChainLadder(Triangle = RAA, R = 999, process.distr = "gamma")

     Latest Mean Ultimate Mean IBNR IBNR.S.E IBNR 75% IBNR 95%
1981 18,834        18,834         0        0        0        0
1982 16,704        16,874       170      751      213    1,435
1983 23,466        24,088       622    1,240    1,039    3,089
1984 27,067        28,785     1,718    1,915    2,758    5,461
1985 26,180        29,085     2,905    2,387    4,148    7,509
1986 15,852        19,561     3,709    2,476    5,189    8,102
1987 12,314        17,835     5,521    3,089    7,197   11,348
1988 13,112        24,170    11,058    4,920   13,952   19,626
1989  5,395        16,271    10,876    5,920   14,529   21,221
1990  2,063        19,929    17,866   14,195   25,820   43,213

                 Totals
Latest:         160,987
Mean Ultimate:  215,431
Mean IBNR:       54,444
IBNR.S.E         18,711
Total IBNR 75%:  65,615
Total IBNR 95%:  87,033</code></pre>
<p>You can use <code>summary(B)$ByOrigin</code> and
<code>summary(B)$Totals</code> to extract the information from the
output above.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChainLadder_files/figure-html/unnamed-chunk-30-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>Quantiles of the bootstrap IBNR can be calculated via the
<code>quantile</code> function:</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">B</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>,<span class="fl">0.95</span>,<span class="fl">0.99</span>, <span class="fl">0.995</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>$ByOrigin
     IBNR 75% IBNR 95% IBNR 99% IBNR 99.5%
1981      0.0        0        0          0
1982    213.4     1435     2841       3733
1983   1039.1     3089     4612       4945
1984   2758.0     5461     7326       8210
1985   4147.9     7509     9487      10452
1986   5188.7     8102    11425      12991
1987   7196.8    11348    14663      15554
1988  13952.0    19626    25384      27311
1989  14529.4    21221    27991      30040
1990  25819.5    43213    59327      69688

$Totals
            Totals
IBNR 75%:    65615
IBNR 95%:    87033
IBNR 99%:   105599
IBNR 99.5%: 113236</code></pre>
<p>The distribution of the IBNR appears to follow a log-normal
distribution, so let’s fit it:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## fit a distribution to the IBNR</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">B</span><span class="op">$</span><span class="va">IBNR.Totals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## fit a log-normal distribution</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/fitdistr.html" class="external-link">fitdistr</a></span><span class="op">(</span><span class="va">B</span><span class="op">$</span><span class="va">IBNR.Totals</span><span class="op">[</span><span class="va">B</span><span class="op">$</span><span class="va">IBNR.Totals</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span>, <span class="st">"lognormal"</span><span class="op">)</span></span>
<span><span class="va">fit</span></span></code></pre></div>
<pre><code>    meanlog      sdlog  
  10.843119    0.361346 
 ( 0.011432) ( 0.008084)</code></pre>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">plnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">fit</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"meanlog"</span><span class="op">]</span>, <span class="va">fit</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"sdlog"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      col<span class="op">=</span><span class="st">"red"</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChainLadder_files/figure-html/unnamed-chunk-32-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="multivariate-chain-ladder">Multivariate chain-ladder<a class="anchor" aria-label="anchor" href="#multivariate-chain-ladder"></a>
</h4>
<p>The Mack chain-ladder technique can be generalized to the
multivariate setting where multiple reserving triangles are modelled and
developed simultaneously. The advantage of the multivariate modelling is
that correlations among different triangles can be modelled, which will
lead to more accurate uncertainty assessments. Reserving methods that
explicitly model the between-triangle contemporaneous correlations can
be found in <span class="citation">(Pröhl and Schmidt 2005)</span>,
<span class="citation">(Michael Merz and Wüthrich 2008b)</span>. Another
benefit of multivariate loss reserving is that structural relationships
between triangles can also be reflected, where the development of one
triangle depends on past losses from other triangles. For example, there
is generally need for the joint development of the paid and incurred
losses <span class="citation">(Quarg and Mack 2004)</span>. Most of the
chain-ladder-based multivariate reserving models can be summarised as
sequential seemingly unrelated regressions <span class="citation">(Zhang
2010)</span>. We note another strand of multivariate loss reserving
builds a hierarchical structure into the model to allow estimation of
one triangle to “borrow strength” from other triangles, reflecting the
core insight of actuarial credibility <span class="citation">(Zhang,
Dukic, and Guszcza 2012)</span>.</p>
<p>Denote
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Y</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><mi>⋯</mi><mo>,</mo><msubsup><mi>Y</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>N</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y_{i,k}=(Y^{(1)}_{i,k}, \cdots ,Y^{(N)}_{i,k})</annotation></semantics></math>
as an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">N
\times 1</annotation></semantics></math> vector of cumulative losses at
accident year
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and development year
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(n)</annotation></semantics></math>
refers to the n-th triangle. <span class="citation">(Zhang 2010)</span>
specifies the model in development period
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>A</mi><mi>k</mi></msub><mo>+</mo><msub><mi>B</mi><mi>k</mi></msub><mo>⋅</mo><msub><mi>Y</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
\begin{equation}
Y_{i,k+1} = A_k + B_k \cdot Y_{i,k} + \epsilon_{i,k},
\end{equation}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>k</mi></msub><annotation encoding="application/x-tex">A_k</annotation></semantics></math>
is a column of intercepts and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mi>k</mi></msub><annotation encoding="application/x-tex">B_k</annotation></semantics></math>
is the development matrix for development period
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.
Assumptions for this model are:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>Y</mi><mrow><mi>i</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>⋯</mi><mo>,</mo><msub><mi>Y</mi><mrow><mi>i</mi><mo>,</mo><mi>I</mi><mo>+</mo><mn>1</mn><mo>−</mo><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mi>c</mi><mi>o</mi><mi>v</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>Y</mi><mrow><mi>i</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>⋯</mi><mo>,</mo><msub><mi>Y</mi><mrow><mi>i</mi><mo>,</mo><mi>I</mi><mo>+</mo><mn>1</mn><mo>−</mo><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>D</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Y</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow><mrow><mo>−</mo><mi>δ</mi><mi>/</mi><mn>2</mn></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><msub><mi>Σ</mi><mi>k</mi></msub><mspace width="0.167em"></mspace><mi>D</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Y</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow><mrow><mo>−</mo><mi>δ</mi><mi>/</mi><mn>2</mn></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">losses of different accident years are independent</mtext><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>ϵ</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> are symmetrically distributed</mtext></mrow><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
&amp;E(\epsilon_{i,k}|Y_{i,1}, \cdots,Y_{i,I+1-k}) =0, \\
&amp;cov(\epsilon_{i,k}|Y_{i,1}, \cdots, Y_{i,I+1-k})=D(Y_{i,k}^{-\delta/2}) \, \Sigma_k \, D(Y_{i,k}^{-\delta/2}), \\
&amp;\text{losses of different accident years are independent}, \\
&amp;\epsilon_{i,k} \text{ are symmetrically distributed}.
\end{aligned}
</annotation></semantics></math></p>
<p>In the above,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
is the diagonal operator, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
is a known positive value that controls how the variance depends on the
mean (as weights). This model is referred to as the general multivariate
chain ladder [GMCL] in <span class="citation">(Zhang 2010)</span>. A
important special case where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>k</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">A_k=0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mi>k</mi></msub><annotation encoding="application/x-tex">B_k</annotation></semantics></math>’s
are diagonal is a naive generalization of the chain-ladder, often
referred to as the multivariate chain-ladder [MCL] <span class="citation">(Pröhl and Schmidt 2005)</span>.</p>
<p>In the following, we first introduce the class
<code>triangles</code>, for which we have defined several utility
functions. Indeed, any input triangles to the
<code>MultiChainLadder</code> function will be converted to
<code>triangles</code> internally. We then present loss reserving
methods based on the MCL and GMCL models in turn.</p>
<p>Consider the two liability loss triangles from <span class="citation">(Michael Merz and Wüthrich 2008b)</span>. It comes as a
list of two matrices:</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">liab</span><span class="op">)</span></span></code></pre></div>
<pre><code>List of 2
 $ GeneralLiab: num [1:14, 1:14] 59966 49685 51914 84937 98921 ...
 $ AutoLiab   : num [1:14, 1:14] 114423 152296 144325 145904 170333 ...</code></pre>
<p>We can convert a list to a <code>triangles</code> object using</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">liab2</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">liab</span>, <span class="st">"triangles"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">liab2</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "triangles"
attr(,"package")
[1] "ChainLadder"</code></pre>
<p>We can find out what methods are available for this class:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">showMethods</span><span class="op">(</span>classes <span class="op">=</span> <span class="st">"triangles"</span><span class="op">)</span></span></code></pre></div>
<p>For example, if we want to extract the last three columns of each
triangle, we can use the <code>[</code> operator as follows:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use drop = TRUE to remove rows that are all NA's</span></span>
<span><span class="va">liab2</span><span class="op">[</span>, <span class="fl">12</span><span class="op">:</span><span class="fl">14</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span></span></code></pre></div>
<pre><code>An object of class "triangles"
[[1]]
       [,1]   [,2]   [,3]
[1,] 540873 547696 549589
[2,] 563571 562795     NA
[3,] 602710     NA     NA

[[2]]
       [,1]   [,2]   [,3]
[1,] 391328 391537 391428
[2,] 485138 483974     NA
[3,] 540742     NA     NA</code></pre>
<p>The following combines two columns of the triangles to form a new
matrix:</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cbind2</span><span class="op">(</span><span class="va">liab2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">12</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>       [,1]   [,2]
[1,] 540873 391328
[2,] 563571 485138
[3,] 602710 540742</code></pre>
</div>
<div class="section level4">
<h4 id="separate-chain-ladder-ignoring-correlations">Separate chain-ladder ignoring correlations<a class="anchor" aria-label="anchor" href="#separate-chain-ladder-ignoring-correlations"></a>
</h4>
<p>The form of regression models used in estimating the development
parameters is controlled by the <code>fit.method</code> argument. If we
specify <code>fit.method = "OLS"</code>, the ordinary least squares will
be used and the estimation of development factors for each triangle is
independent of the others. In this case, the residual covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Σ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\Sigma_k</annotation></semantics></math>
is diagonal. As a result, the multivariate model is equivalent to
running multiple Mack chain-ladders separately.</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MultiChainLadder.html">MultiChainLadder</a></span><span class="op">(</span><span class="va">liab</span>, fit.method <span class="op">=</span> <span class="st">"OLS"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span><span class="op">$</span><span class="va">report.summary</span>, <span class="st">"["</span>, <span class="fl">15</span>, <span class="op">)</span></span></code></pre></div>
<pre><code>$`Summary Statistics for Triangle 1`
        Latest Dev.To.Date Ultimate    IBNR    S.E     CV
Total 11343397      0.6482 17498658 6155261 427289 0.0694

$`Summary Statistics for Triangle 2`
       Latest Dev.To.Date Ultimate    IBNR    S.E     CV
Total 8759806      0.8093 10823418 2063612 162872 0.0789

$`Summary Statistics for Triangle 1+2`
        Latest Dev.To.Date Ultimate    IBNR    S.E     CV
Total 20103203      0.7098 28322077 8218874 457278 0.0556</code></pre>
<p>In the above, we only show the total reserve estimate for each
triangle to reduce the output. The full summary including the estimate
for each year can be retrieved using the usual <code>summary</code>
function. By default, the <code>summary</code> function produces reserve
statistics for all individual triangles, as well as for the portfolio
that is assumed to be the sum of the two triangles. This behaviour can
be changed by supplying the <code>portfolio</code> argument. See the
documentation for details.</p>
<p>We can verify if this is indeed the same as the univariate Mack chain
ladder. For example, we can apply the <code>MackChainLadder</code>
function to each triangle:</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">liab</span>, <span class="va">MackChainLadder</span>, est.sigma <span class="op">=</span> <span class="st">"Mack"</span><span class="op">)</span></span>
<span><span class="co"># the same as the first triangle above</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">fit</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">Totals</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>$GeneralLiab
        Latest:   Dev: Ultimate:   IBNR: Mack S.E.: CV(IBNR):
Totals 11343397 0.6482  17498658 6155261     427289   0.06942

$AutoLiab
       Latest:   Dev: Ultimate:   IBNR: Mack S.E.: CV(IBNR):
Totals 8759806 0.8093  10823418 2063612     162872   0.07893</code></pre>
<p>The argument <code>mse.method</code> controls how the mean square
errors are computed. By default, it implements the Mack method. An
alternative method is the conditional re-sampling approach in <span class="citation">(Buchwalder et al. 2006)</span>, which assumes the
estimated parameters are independent. This is used when
<code>mse.method = "Independence"</code>. For example, the following
reproduces the result in <span class="citation">(Buchwalder et al.
2006)</span>. Note that the first argument must be a list, even though
only one triangle is used.</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">B1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MultiChainLadder.html">MultiChainLadder</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">GenIns</span><span class="op">)</span>, fit.method <span class="op">=</span> <span class="st">"OLS"</span>,</span>
<span>    mse.method <span class="op">=</span> <span class="st">"Independence"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>$`Summary Statistics for Input Triangle`
          Latest Dev.To.Date   Ultimate       IBNR       S.E    CV
1      3,901,463      1.0000  3,901,463          0         0 0.000
2      5,339,085      0.9826  5,433,719     94,634    75,535 0.798
3      4,909,315      0.9127  5,378,826    469,511   121,700 0.259
4      4,588,268      0.8661  5,297,906    709,638   133,551 0.188
5      3,873,311      0.7973  4,858,200    984,889   261,412 0.265
6      3,691,712      0.7223  5,111,171  1,419,459   411,028 0.290
7      3,483,130      0.6153  5,660,771  2,177,641   558,356 0.256
8      2,864,498      0.4222  6,784,799  3,920,301   875,430 0.223
9      1,363,294      0.2416  5,642,266  4,278,972   971,385 0.227
10       344,014      0.0692  4,969,825  4,625,811 1,363,385 0.295
Total 34,358,090      0.6478 53,038,946 18,680,856 2,447,618 0.131</code></pre>
</div>
<div class="section level4">
<h4 id="multivariate-chain-ladder-using-seemingly-unrelated-regressions">Multivariate chain-ladder using seemingly unrelated regressions<a class="anchor" aria-label="anchor" href="#multivariate-chain-ladder-using-seemingly-unrelated-regressions"></a>
</h4>
<p>To allow correlations to be incorporated, we employ the seemingly
unrelated regressions (see the package <code>systemfit</code>, <span class="citation">(Henningsen and Hamann 2007)</span>) that
simultaneously model the two triangles in each development period. This
is invoked when we specify <code>fit.method = "SUR"</code>:</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MultiChainLadder.html">MultiChainLadder</a></span><span class="op">(</span><span class="va">liab</span>, fit.method <span class="op">=</span> <span class="st">"SUR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span><span class="op">$</span><span class="va">report.summary</span>, <span class="st">"["</span>, <span class="fl">15</span>, <span class="op">)</span></span></code></pre></div>
<pre><code>$`Summary Statistics for Triangle 1`
        Latest Dev.To.Date Ultimate    IBNR    S.E     CV
Total 11343397      0.6484 17494907 6151510 419293 0.0682

$`Summary Statistics for Triangle 2`
       Latest Dev.To.Date Ultimate    IBNR    S.E     CV
Total 8759806      0.8095 10821341 2061535 162464 0.0788

$`Summary Statistics for Triangle 1+2`
        Latest Dev.To.Date Ultimate    IBNR    S.E    CV
Total 20103203        0.71 28316248 8213045 500607 0.061</code></pre>
<p>We see that the portfolio prediction error is inflated to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>500</mn><mo>,</mo><mn>607</mn></mrow><annotation encoding="application/x-tex">500,607</annotation></semantics></math>
from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>457</mn><mo>,</mo><mn>278</mn></mrow><annotation encoding="application/x-tex">457,278</annotation></semantics></math>
in the separate development model (“OLS”). This is because of the
positive correlation between the two triangles. The estimated
correlation for each development period can be retrieved through the
<code>residCor</code> function:</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="../reference/residCov-methods.html">residCor</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code> [1]  0.247  0.495  0.682  0.446  0.487  0.451 -0.172  0.805  0.337  0.688
[11] -0.004  1.000  0.021</code></pre>
<p>Similarly, most methods that work for linear models such as
<code>coef</code>, <code>fitted</code>, <code>resid</code> and so on
will also work. Since we have a sequence of models, the retrieved
results from these methods are stored in a list. For example, we can
retrieve the estimated development factors for each period as</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>      eq1_x[[1]] eq2_x[[2]]
 [1,]      3.227     2.2224
 [2,]      1.719     1.2688
 [3,]      1.352     1.1200
 [4,]      1.179     1.0665
 [5,]      1.106     1.0356
 [6,]      1.055     1.0168
 [7,]      1.026     1.0097
 [8,]      1.015     1.0002
 [9,]      1.012     1.0038
[10,]      1.006     0.9994
[11,]      1.005     1.0039
[12,]      1.005     0.9989
[13,]      1.003     0.9997</code></pre>
<p>The smaller-than-one development factors after the 10-th period for
the second triangle indeed result in negative IBNR estimates for the
first several accident years in that triangle.</p>
<p>The package also offers the <code>plot</code> method that produces
various summary and diagnostic figures:</p>
<div class="figure" style="text-align: center">
<img src="ChainLadder_files/figure-html/multi-1.png" alt="Summary and diagnostic plots from a `MultiChainLadder` object" width="60%"><p class="caption">
Summary and diagnostic plots from a <code>MultiChainLadder</code> object
</p>
</div>
<p>The resulting plots are shown in figure above. We use
<code>which.triangle</code> to suppress the plot for the portfolio, and
use <code>which.plot</code> to select the desired types of plots. See
the documentation for possible values of these two arguments.</p>
</div>
<div class="section level4">
<h4 id="other-residual-covariance-estimation-methods">Other residual covariance estimation methods<a class="anchor" aria-label="anchor" href="#other-residual-covariance-estimation-methods"></a>
</h4>
<p>Internally, the <code>MultiChainLadder</code> calls the
<code>systemfit</code> function to fit the regression models period by
period. When SUR models are specified, there are several ways to
estimate the residual covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Σ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\Sigma_k</annotation></semantics></math>.
Available methods are <code>noDfCor</code>, <code>geomean</code>,
<code>max</code>, and <code>Theil</code> with the default as
<code>geomean</code>. The method <code>Theil</code> will produce
unbiased covariance estimate, but the resulting estimate may not be
positive semi-definite. This is also the estimator used by <span class="citation">(Michael Merz and Wüthrich 2008b)</span>. However, this
method does not work out of the box for the <code>liab</code> data, and
is perhaps one of the reasons <span class="citation">(Michael Merz and
Wüthrich 2008b)</span> used extrapolation to get the estimate for the
last several periods.</p>
<p>Indeed, for most applications, we recommend the use of separate chain
ladders for the tail periods to stabilize the estimation - there are few
data points in the tail and running a multivariate model often produces
extremely volatile estimates or even fails. To facilitate such an
approach, the package offers the <code>MultiChainLadder2</code>
function, which implements a split-and-join procedure: we split the
input data into two parts, specify a multivariate model with rich
structures on the first part (with enough data) to reflect the
multivariate dependencies, apply separate univariate chain-ladders on
the second part, and then join the two models together to produce the
final predictions. The splitting is determined by the <code>last</code>
argument, which specifies how many of the development periods in the
tail go into the second part of the split. The type of the model
structure to be specified for the first part of the split model in
<code>MultiChainLadder2</code> is controlled by the <code>type</code>
argument. It takes one of the following values: <code>MCL</code> - the
multivariate chain-ladder with diagonal development matrix;
<code>MCL+int</code> - the multivariate chain-ladder with additional
intercepts; <code>GMCL-int</code> - the general multivariate
chain-ladder without intercepts; and <code>GMCL</code> - the full
general multivariate chain-ladder with intercepts and non-diagonal
development matrix.</p>
<p>For example, the following fits the SUR method to the first part (the
first 11 columns) using the unbiased residual covariance estimator in
<span class="citation">(Michael Merz and Wüthrich 2008b)</span>, and
separate chain-ladders for the rest:</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/systemfit/" class="external-link">systemfit</a></span><span class="op">)</span></span>
<span><span class="va">W1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MultiChainLadder.html">MultiChainLadder2</a></span><span class="op">(</span><span class="va">liab</span>, mse.method <span class="op">=</span> <span class="st">"Independence"</span>,</span>
<span>        control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/systemfit/man/systemfit.control.html" class="external-link">systemfit.control</a></span><span class="op">(</span>methodResidCov <span class="op">=</span> <span class="st">"Theil"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">W1</span><span class="op">)</span><span class="op">$</span><span class="va">report.summary</span>, <span class="st">"["</span>, <span class="fl">15</span>, <span class="op">)</span></span></code></pre></div>
<pre><code>$`Summary Statistics for Triangle 1`
        Latest Dev.To.Date Ultimate    IBNR    S.E     CV
Total 11343397      0.6483 17497403 6154006 427041 0.0694

$`Summary Statistics for Triangle 2`
       Latest Dev.To.Date Ultimate    IBNR    S.E    CV
Total 8759806      0.8095 10821034 2061228 162785 0.079

$`Summary Statistics for Triangle 1+2`
        Latest Dev.To.Date Ultimate    IBNR    S.E     CV
Total 20103203      0.7099 28318437 8215234 505376 0.0615</code></pre>
<p>Similarly, the iterative residual covariance estimator in <span class="citation">(Michael Merz and Wüthrich 2008b)</span> can also be
used, in which we use the control parameter <code>maxiter</code> to
determine the number of iterations:</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">W2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MultiChainLadder.html">MultiChainLadder2</a></span><span class="op">(</span><span class="va">liab</span>, mse.method <span class="op">=</span> <span class="st">"Independence"</span>,</span>
<span>      control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/systemfit/man/systemfit.control.html" class="external-link">systemfit.control</a></span><span class="op">(</span>methodResidCov <span class="op">=</span> <span class="st">"Theil"</span>, maxiter <span class="op">=</span> <span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">W2</span><span class="op">)</span><span class="op">@</span><span class="va">report.summary</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">15</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>          digits <span class="op">=</span> <span class="fl">6</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code>           IBNR     S.E
Total 8,215,234 505,376
           IBNR     S.E
Total 8,215,357 505,443
           IBNR     S.E
Total 8,215,362 505,444
           IBNR     S.E
Total 8,215,362 505,444
           IBNR     S.E
Total 8,215,362 505,444</code></pre>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">W2</span><span class="op">)</span><span class="op">$</span><span class="va">report.summary</span>, <span class="st">"["</span>, <span class="fl">15</span>, <span class="op">)</span></span></code></pre></div>
<pre><code>$`Summary Statistics for Triangle 1`
        Latest Dev.To.Date Ultimate    IBNR    S.E     CV
Total 11343397      0.6483 17497526 6154129 427074 0.0694

$`Summary Statistics for Triangle 2`
       Latest Dev.To.Date Ultimate    IBNR    S.E    CV
Total 8759806      0.8095 10821039 2061233 162790 0.079

$`Summary Statistics for Triangle 1+2`
        Latest Dev.To.Date Ultimate    IBNR    S.E     CV
Total 20103203      0.7099 28318565 8215362 505444 0.0615</code></pre>
<p>We see that the covariance estimate converges in three steps. These
are very similar to the results in <span class="citation">(Michael Merz
and Wüthrich 2008b)</span>, the small difference being a result of the
different approaches used in the last three periods.</p>
<p>Also note that in the above two examples, the argument
<code>control</code> is not defined in the prototype of the
<code>MultiChainLadder</code>. It is an argument that is passed to the
<code>systemfit</code> function through the <code>...</code> mechanism.
Users are encouraged to explore how other options available in
<code>systemfit</code> can be applied.</p>
</div>
<div class="section level4">
<h4 id="model-with-intercepts">Model with intercepts<a class="anchor" aria-label="anchor" href="#model-with-intercepts"></a>
</h4>
<p>Consider the <code>auto</code> triangles from <span class="citation">(Zhang 2010)</span>. It includes three automobile
insurance triangles: personal auto paid, personal auto incurred, and
commercial auto paid.</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">auto</span><span class="op">)</span></span></code></pre></div>
<pre><code>List of 3
 $ PersonalAutoPaid    : num [1:10, 1:10] 101125 102541 114932 114452 115597 ...
 $ PersonalAutoIncurred: num [1:10, 1:10] 325423 323627 358410 405319 434065 ...
 $ CommercialAutoPaid  : num [1:10, 1:10] 19827 22331 22533 23128 25053 ...</code></pre>
<p>It is a reasonable expectation that these triangles will be
correlated. So we run a MCL model on them:</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MultiChainLadder.html">MultiChainLadder2</a></span><span class="op">(</span><span class="va">auto</span>, type <span class="op">=</span> <span class="st">"MCL"</span><span class="op">)</span></span>
<span><span class="co"># show correlation- the last three columns have zero correlation</span></span>
<span><span class="co"># because separate chain-ladders are used</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="fu"><a href="../reference/residCov-methods.html">residCor</a></span><span class="op">(</span><span class="va">f0</span><span class="op">)</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>       [,1]    [,2]  [,3]  [,4]    [,5]  [,6] [,7] [,8] [,9]
(1,2) 0.327 -0.0101 0.598 0.711  0.8565 0.928    0    0    0
(1,3) 0.870  0.9064 0.939 0.261 -0.0607 0.911    0    0    0
(2,3) 0.198 -0.3217 0.558 0.380  0.3586 0.931    0    0    0</code></pre>
<p>However, from the residual plot, the first row in Figure
@ref(fig:multi_resid), it is evident that the default mean structure in
the MCL model is not adequate. Usually this is a common problem with the
chain-ladder based models, owing to the missing of intercepts.</p>
<p>We can improve the above model by including intercepts in the SUR fit
as follows:</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MultiChainLadder.html">MultiChainLadder2</a></span><span class="op">(</span><span class="va">auto</span>, type <span class="op">=</span> <span class="st">"MCL+int"</span><span class="op">)</span></span></code></pre></div>
<p>The corresponding residual plot is shown in the second row in the
figure below. We see that these residuals are randomly scattered around
zero and there is no clear pattern compared to the plot from the MCL
model.</p>
<p><span style="color:red"> <strong>!The rest of this and the following
section needs updating following changes to the Matrix package!</strong>
</span></p>
<p>The default summary computes the portfolio estimates as the sum of
all the triangles. This is not desirable because the first two triangles
are both from the personal auto line. We can overwrite this via the
<code>portfolio</code> argument. For example, the following uses the two
paid triangles as the portfolio estimate:</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">f1</span>, portfolio <span class="op">=</span> <span class="st">"1+3"</span><span class="op">)</span><span class="op">@</span><span class="va">report.summary</span>, <span class="st">"["</span>, <span class="fl">11</span>, <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="joint-modelling-of-the-paid-and-incurred-losses">Joint modelling of the paid and incurred losses<a class="anchor" aria-label="anchor" href="#joint-modelling-of-the-paid-and-incurred-losses"></a>
</h4>
<p>Although the model with intercepts proved to be an improvement over
the MCL model, it still fails to account for the structural relationship
between triangles. In particular, it produces divergent paid-to-incurred
loss ratios for the personal auto line:</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ult</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span><span class="op">$</span><span class="va">Ultimate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ult</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">/</span><span class="va">ult</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>We see that for accident years 9-10, the paid-to-incurred loss ratios
are more than 110%. This can be fixed by allowing the development of the
paid/incurred triangles to depend on each other. That is, we include the
past values from the paid triangle as predictors when developing the
incurred triangle, and vice versa.</p>
<p>We illustrate this ignoring the commercial auto triangle. See the
demo for a model that uses all three triangles. We also include the MCL
model and the Munich chain-ladder as a comparison:</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">da</span> <span class="op">&lt;-</span> <span class="va">auto</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="co"># MCL with diagonal development</span></span>
<span><span class="va">M0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MultiChainLadder.html">MultiChainLadder</a></span><span class="op">(</span><span class="va">da</span><span class="op">)</span></span>
<span><span class="co"># non-diagonal development matrix with no intercepts</span></span>
<span><span class="va">M1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MultiChainLadder.html">MultiChainLadder2</a></span><span class="op">(</span><span class="va">da</span>, type <span class="op">=</span> <span class="st">"GMCL-int"</span><span class="op">)</span></span>
<span><span class="co"># Munich chain-ladder</span></span>
<span><span class="va">M2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MunichChainLadder.html">MunichChainLadder</a></span><span class="op">(</span><span class="va">da</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">da</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># compile results and compare projected paid to incured ratios</span></span>
<span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">M0</span>, <span class="va">M1</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>          <span class="va">ult</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">@</span><span class="va">Ultimate</span></span>
<span>          <span class="va">ult</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">ult</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">r1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MCL"</span>, <span class="st">"GMCL"</span><span class="op">)</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">M2</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">6</span><span class="op">]</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">r2</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">M2</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">r1</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>MuCl <span class="op">=</span> <span class="va">r2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="clarks-methods">Clark’s methods<a class="anchor" aria-label="anchor" href="#clarks-methods"></a>
</h3>
<p>The ChainLadder package contains functionality to carry out the
methods described in the paper<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This paper is on the CAS Exam 6 syllabus&lt;/p&gt;"><sup>3</sup></a> by David Clark <span class="citation">(Clark 2003)</span>. Using a longitudinal analysis
approach, Clark assumes that losses develop according to a theoretical
<em>growth curve</em>. The LDF method is a special case of this approach
where the growth curve can be considered to be either a step function or
piecewise linear. Clark envisions a growth curve as measuring the
percent of ultimate loss that can be expected to have emerged as of each
age of an origin period. The paper describes two methods that fit this
model.</p>
<p>The LDF method assumes that the ultimate losses in each origin period
are separate and unrelated. The goal of the method, therefore, is to
estimate parameters for the ultimate losses and for the growth curve in
order to maximize the likelihood of having observed the data in the
triangle.</p>
<p>The CapeCod method assumes that the <em>apriori</em> expected
ultimate losses in each origin year are the product of earned premium
that year and a theoretical loss ratio. The CapeCod method, therefore,
need estimate potentially far fewer parameters: for the growth function
and for the theoretical loss ratio.</p>
<p>One of the side benefits of using maximum likelihood to estimate
parameters is that its associated asymptotic theory provides uncertainty
estimates for the parameters. Observing that the reserve estimates by
origin year are functions of the estimated parameters, uncertainty
estimates of these functional values are calculated according to the
<em>Delta method</em>, which is essentially a linearisation of the
problem based on a Taylor series expansion.</p>
<p>The two functional forms for growth curves considered in Clark’s
paper are the log-logistic function (a.k.a., the inverse power curve)
and the Weibull function, both being two-parameter functions. Clark uses
the parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ω</mi><annotation encoding="application/x-tex">\omega</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
in his paper. Clark’s methods work on incremental losses. His likelihood
function is based on the assumption that incremental losses follow an
over-dispersed Poisson (ODP) process.</p>
<div class="section level4">
<h4 id="clarks-ldf-method">Clark’s LDF method<a class="anchor" aria-label="anchor" href="#clarks-ldf-method"></a>
</h4>
<p>Consider again the RAA triangle. Accepting all defaults, the Clark
LDF Method would estimate total ultimate losses of 272,009 and a reserve
(FutureValue) of 111,022, or almost twice the value based on the volume
weighted average link ratios and loglinear fit in section 3.2.1
above.</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ClarkLDF.html">ClarkLDF</a></span><span class="op">(</span><span class="va">RAA</span><span class="op">)</span></span></code></pre></div>
<pre><code> Origin CurrentValue    Ldf UltimateValue FutureValue StdError  CV%
   1981       18,834  1.216        22,906       4,072    2,792 68.6
   1982       16,704  1.251        20,899       4,195    2,833 67.5
   1983       23,466  1.297        30,441       6,975    4,050 58.1
   1984       27,067  1.360        36,823       9,756    5,147 52.8
   1985       26,180  1.451        37,996      11,816    5,858 49.6
   1986       15,852  1.591        25,226       9,374    4,877 52.0
   1987       12,314  1.829        22,528      10,214    5,206 51.0
   1988       13,112  2.305        30,221      17,109    7,568 44.2
   1989        5,395  3.596        19,399      14,004    7,506 53.6
   1990        2,063 12.394        25,569      23,506   17,227 73.3
  Total      160,987              272,009     111,022   36,102 32.5</code></pre>
<p>Most of the difference is due to the heavy tail, 21.6%, implied by
the inverse power curve fit. Clark recognizes that the log-logistic
curve can take an unreasonably long length of time to flatten out. If
according to the actuary’s experience most claims close as of, say, 20
years, the growth curve can be truncated accordingly by using the
<code>maxage</code> argument:</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ClarkLDF.html">ClarkLDF</a></span><span class="op">(</span><span class="va">RAA</span>, maxage <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<pre><code> Origin CurrentValue    Ldf UltimateValue FutureValue StdError  CV%
   1981       18,834  1.124        21,168       2,334    1,765 75.6
   1982       16,704  1.156        19,314       2,610    1,893 72.6
   1983       23,466  1.199        28,132       4,666    2,729 58.5
   1984       27,067  1.257        34,029       6,962    3,559 51.1
   1985       26,180  1.341        35,113       8,933    4,218 47.2
   1986       15,852  1.471        23,312       7,460    3,775 50.6
   1987       12,314  1.691        20,819       8,505    4,218 49.6
   1988       13,112  2.130        27,928      14,816    6,300 42.5
   1989        5,395  3.323        17,927      12,532    6,658 53.1
   1990        2,063 11.454        23,629      21,566   15,899 73.7
  Total      160,987              251,369      90,382   26,375 29.2</code></pre>
<p>The Weibull growth curve tends to be faster developing than the
log-logistic:</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ClarkLDF.html">ClarkLDF</a></span><span class="op">(</span><span class="va">RAA</span>, G<span class="op">=</span><span class="st">"weibull"</span><span class="op">)</span></span></code></pre></div>
<pre><code> Origin CurrentValue   Ldf UltimateValue FutureValue StdError   CV%
   1981       18,834 1.022        19,254         420      700 166.5
   1982       16,704 1.037        17,317         613      855 139.5
   1983       23,466 1.060        24,875       1,409    1,401  99.4
   1984       27,067 1.098        29,728       2,661    2,037  76.5
   1985       26,180 1.162        30,419       4,239    2,639  62.2
   1986       15,852 1.271        20,151       4,299    2,549  59.3
   1987       12,314 1.471        18,114       5,800    3,060  52.8
   1988       13,112 1.883        24,692      11,580    4,867  42.0
   1989        5,395 2.988        16,122      10,727    5,544  51.7
   1990        2,063 9.815        20,248      18,185   12,929  71.1
  Total      160,987             220,920      59,933   19,149  32.0</code></pre>
<p>It is recommend to inspect the residuals to help assess the
reasonableness of the model relative to the actual data.</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/ClarkLDF.html">ClarkLDF</a></span><span class="op">(</span><span class="va">RAA</span>, G<span class="op">=</span><span class="st">"weibull"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChainLadder_files/figure-html/LDFweibull-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>Although there is some evidence of heteroscedasticity with increasing
ages and fitted values, the residuals otherwise appear randomly
scattered around a horizontal line through the origin. The q-q plot
shows evidence of a lack of fit in the tails, but the p-value of almost
0.2 can be considered too high to reject outright the assumption of
normally distributed standardized residuals<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;As an exercise, the reader can confirm that the normal
distribution assumption is rejected at the 5% level with the
log-logistic curve&lt;/p&gt;"><sup>4</sup></a>.</p>
</div>
<div class="section level4">
<h4 id="clarks-cape-cod-method">Clark’s Cape Cod method<a class="anchor" aria-label="anchor" href="#clarks-cape-cod-method"></a>
</h4>
<p>The RAA data set, widely researched in the literature, has no premium
associated with it traditionally. Let’s assume a constant earned premium
of 40000 each year, and a Weibull growth function:</p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ClarkCapeCod.html">ClarkCapeCod</a></span><span class="op">(</span><span class="va">RAA</span>, Premium <span class="op">=</span> <span class="fl">40000</span>, G <span class="op">=</span> <span class="st">"weibull"</span><span class="op">)</span></span></code></pre></div>
<pre><code> Origin CurrentValue Premium   ELR FutureGrowthFactor FutureValue UltimateValue
   1981       18,834  40,000 0.566             0.0192         436        19,270
   1982       16,704  40,000 0.566             0.0320         725        17,429
   1983       23,466  40,000 0.566             0.0525       1,189        24,655
   1984       27,067  40,000 0.566             0.0848       1,921        28,988
   1985       26,180  40,000 0.566             0.1345       3,047        29,227
   1986       15,852  40,000 0.566             0.2093       4,741        20,593
   1987       12,314  40,000 0.566             0.3181       7,206        19,520
   1988       13,112  40,000 0.566             0.4702      10,651        23,763
   1989        5,395  40,000 0.566             0.6699      15,176        20,571
   1990        2,063  40,000 0.566             0.9025      20,444        22,507
  Total      160,987 400,000                               65,536       226,523
 StdError   CV%
      692 158.6
      912 125.7
    1,188  99.9
    1,523  79.3
    1,917  62.9
    2,360  49.8
    2,845  39.5
    3,366  31.6
    3,924  25.9
    4,491  22.0
   12,713  19.4</code></pre>
<p>The estimated expected loss ratio is 0.566. The total outstanding
loss is about 10% higher than with the LDF method. The standard error,
however, is lower, probably due to the fact that there are fewer
parameters to estimate with the CapeCod method, resulting in less
parameter risk.</p>
<p>A plot of this model shows similar residuals By Origin and Projected
Age to those from the LDF method, a better spread By Fitted Value, and a
slightly better q-q plot, particularly in the upper tail.</p>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/ClarkCapeCod.html">ClarkCapeCod</a></span><span class="op">(</span><span class="va">RAA</span>, Premium <span class="op">=</span> <span class="fl">40000</span>, G <span class="op">=</span> <span class="st">"weibull"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChainLadder_files/figure-html/CapeCod-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="generalised-linear-model-methods">Generalised linear model methods<a class="anchor" aria-label="anchor" href="#generalised-linear-model-methods"></a>
</h3>
<p>Recent years have also seen growing interest in using generalised
linear models [GLM] for insurance loss reserving. The use of GLM in
insurance loss reserving has many compelling aspects, e.g.,</p>
<ul>
<li>when over-dispersed Poisson model is used, it reproduces the
estimates from chain-ladder;</li>
<li>it provides a more coherent modelling framework than the Mack
method;</li>
<li>all the relevant established statistical theory can be directly
applied to perform hypothesis testing and diagnostic checking;</li>
</ul>
<p>The <code>glmReserve</code> function takes an insurance loss
triangle, converts it to incremental losses internally if necessary,
transforms it to the long format (see <code>as.data.frame</code>) and
fits the resulting loss data with a generalised linear model where the
mean structure includes both the accident year and the development lag
effects. The function also provides both analytical and bootstrapping
methods to compute the associated prediction errors. The bootstrapping
approach also simulates the full predictive distribution, based on which
the user can compute other uncertainty measures such as predictive
intervals.</p>
<p>Only the Tweedie family of distributions are allowed, that is, the
exponential family that admits a power variance function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>μ</mi><mi>p</mi></msup></mrow><annotation encoding="application/x-tex">V(\mu)=\mu^p</annotation></semantics></math>.
The variance power
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
is specified in the <code>var.power</code> argument, and controls the
type of the distribution. When the Tweedie compound Poisson distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>&lt;</mo><mi>p</mi><mo>&lt;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">1 &lt; p &lt;
2</annotation></semantics></math> is to be used, the user has the option
to specify <code>var.power = NULL</code>, where the variance power
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
will be estimated from the data using the <code>cplm</code> package
<span class="citation">(Zhang 2012)</span>.</p>
<p>For example, the following fits the over-dispersed Poisson model and
spells out the estimated reserve information:</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">GenIns</span><span class="op">)</span></span>
<span><span class="va">GenIns</span> <span class="op">&lt;-</span> <span class="va">GenIns</span> <span class="op">/</span> <span class="fl">1000</span></span>
<span><span class="co"># fit Poisson GLM</span></span>
<span><span class="op">(</span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/glmReserve.html">glmReserve</a></span><span class="op">(</span><span class="va">GenIns</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>      Latest Dev.To.Date Ultimate  IBNR    S.E     CV
2       5339     0.98252     5434    95  110.1 1.1589
3       4909     0.91263     5379   470  216.0 0.4597
4       4588     0.86599     5298   710  260.9 0.3674
5       3873     0.79725     4858   985  303.6 0.3082
6       3692     0.72235     5111  1419  375.0 0.2643
7       3483     0.61527     5661  2178  495.4 0.2274
8       2864     0.42221     6784  3920  790.0 0.2015
9       1363     0.24162     5642  4279 1046.5 0.2446
10       344     0.06922     4970  4626 1980.1 0.4280
total  30457     0.61982    49138 18681 2945.7 0.1577</code></pre>
<p>We can also extract the underlying GLM model by specifying
<code>type = "model"</code> in the <code>summary</code> function:</p>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit1</span>, type <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span></span></code></pre></div>
<pre><code>
Call:
glm(formula = value ~ factor(origin) + factor(dev), family = fam, 
    data = ldaFit, offset = offset)

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       5.59865    0.17292   32.38  &lt; 2e-16 ***
factor(origin)2   0.33127    0.15354    2.16   0.0377 *  
factor(origin)3   0.32112    0.15772    2.04   0.0492 *  
factor(origin)4   0.30596    0.16074    1.90   0.0650 .  
factor(origin)5   0.21932    0.16797    1.31   0.1999    
factor(origin)6   0.27008    0.17076    1.58   0.1225    
factor(origin)7   0.37221    0.17445    2.13   0.0398 *  
factor(origin)8   0.55333    0.18653    2.97   0.0053 ** 
factor(origin)9   0.36893    0.23918    1.54   0.1317    
factor(origin)10  0.24203    0.42756    0.57   0.5749    
factor(dev)2      0.91253    0.14885    6.13  4.7e-07 ***
factor(dev)3      0.95883    0.15257    6.28  2.9e-07 ***
factor(dev)4      1.02600    0.15688    6.54  1.3e-07 ***
factor(dev)5      0.43528    0.18391    2.37   0.0234 *  
factor(dev)6      0.08006    0.21477    0.37   0.7115    
factor(dev)7     -0.00638    0.23829   -0.03   0.9788    
factor(dev)8     -0.39445    0.31029   -1.27   0.2118    
factor(dev)9      0.00938    0.32025    0.03   0.9768    
factor(dev)10    -1.37991    0.89669   -1.54   0.1326    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Tweedie family taken to be 52.6)

    Null deviance: 10699  on 54  degrees of freedom
Residual deviance:  1903  on 36  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 4</code></pre>
<p>Similarly, we can fit the Gamma and a compound Poisson GLM reserving
model by changing the <code>var.power</code> argument:</p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Gamma GLM</span></span>
<span><span class="op">(</span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/glmReserve.html">glmReserve</a></span><span class="op">(</span><span class="va">GenIns</span>, var.power <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>      Latest Dev.To.Date Ultimate  IBNR     S.E     CV
2       5339     0.98288     5432    93   45.17 0.4857
3       4909     0.91655     5356   447  160.56 0.3592
4       4588     0.88248     5199   611  177.62 0.2907
5       3873     0.79611     4865   992  254.47 0.2565
6       3692     0.71757     5145  1453  351.33 0.2418
7       3483     0.61440     5669  2186  526.29 0.2408
8       2864     0.43870     6529  3665  941.32 0.2568
9       1363     0.24854     5485  4122 1175.95 0.2853
10       344     0.07078     4860  4516 1667.39 0.3692
total  30457     0.62742    48543 18086 2702.71 0.1494</code></pre>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compound Poisson GLM (variance function estimated from the data):</span></span>
<span><span class="co"># (fit3 &lt;- glmReserve(GenIns, var.power = NULL))</span></span></code></pre></div>
<p>By default, the formulaic approach is used to compute the prediction
errors. We can also carry out bootstrapping simulations by specifying
<code>mse.method = "bootstrap"</code> (note that this argument supports
partial match):</p>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">fit5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/glmReserve.html">glmReserve</a></span><span class="op">(</span><span class="va">GenIns</span>, mse.method <span class="op">=</span> <span class="st">"boot"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>      Latest Dev.To.Date Ultimate  IBNR    S.E     CV
2       5339     0.98252     5434    95  108.7 1.1440
3       4909     0.91263     5379   470  207.8 0.4421
4       4588     0.86599     5298   710  270.4 0.3809
5       3873     0.79725     4858   985  306.6 0.3112
6       3692     0.72235     5111  1419  387.6 0.2732
7       3483     0.61527     5661  2178  493.3 0.2265
8       2864     0.42221     6784  3920  813.1 0.2074
9       1363     0.24162     5642  4279 1077.3 0.2518
10       344     0.06922     4970  4626 1986.3 0.4294
total  30457     0.61982    49138 18681 2955.4 0.1582</code></pre>
<p>When bootstrapping is used, the resulting object has three additional
components - <code>sims.par</code>, <code>sims.reserve.mean</code>, and
<code>sims.reserve.pred</code> that store the simulated parameters, mean
values and predicted values of the reserves for each year,
respectively.</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit5</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "call"              "summary"           "Triangle"         
[4] "FullTriangle"      "model"             "sims.par"         
[7] "sims.reserve.mean" "sims.reserve.pred"</code></pre>
<p>We can thus compute the quantiles of the predictions based on the
simulated samples in the <code>sims.reserve.pred</code> element as:</p>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">fit5</span><span class="op">$</span><span class="va">sims.reserve.pred</span><span class="op">)</span></span>
<span><span class="va">qv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.975</span><span class="op">)</span></span>
<span><span class="va">res.q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pr</span>, <span class="fl">2</span>, <span class="va">quantile</span>, <span class="va">qv</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res.q</span><span class="op">)</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>, quote <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>   2.5%  25%   50%   75%   97.5%
2      0    40    91   175   375
3    125   339   463   612   941
4    290   551   720   910 1,330
5    507   797   991 1,195 1,686
6    812 1,194 1,424 1,691 2,305
7  1,345 1,873 2,161 2,536 3,258
8  2,595 3,427 3,951 4,517 5,742
9  2,462 3,555 4,222 4,988 6,879
10   809 3,394 4,505 5,904 9,236</code></pre>
<p>The full predictive distribution of the simulated reserves for each
year can be visualized easily:</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">prm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span><span class="va">pr</span>, varying<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pr</span><span class="op">)</span><span class="op">)</span>, v.names <span class="op">=</span> <span class="st">"reserve"</span>, </span>
<span>               timevar <span class="op">=</span> <span class="st">"year"</span>, direction<span class="op">=</span><span class="st">"long"</span><span class="op">)</span></span>
<span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">prm</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">reserve</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="va">gg</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">year</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">year</span>, nrow <span class="op">=</span> <span class="fl">2</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gg</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="glmReservePlot.png" alt="The predictive distribution of loss reserves for each year based on bootstrapping" width="60%"><p class="caption">
The predictive distribution of loss reserves for each year based on
bootstrapping
</p>
</div>
</div>
<div class="section level3">
<h3 id="paid-incurred-chain-model">Paid-incurred chain model<a class="anchor" aria-label="anchor" href="#paid-incurred-chain-model"></a>
</h3>
<p>The Paid-incurred chain model was published by Merz and Wüthrich in
2010 <span class="citation">(M. Merz and Wüthrich 2010)</span>. It
combines claims payments and incurred losses information in a a
mathematically rigorous and consistent way to get a unified ultimate
loss prediction.</p>
<div class="section level4">
<h4 id="model-assumptions">Model assumptions<a class="anchor" aria-label="anchor" href="#model-assumptions"></a>
</h4>
<p>The model assumptions for the Log-Normal PIC Model are the
following:</p>
<ul>
<li>Conditionally, given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Θ</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>Φ</mi><mn>0</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>Φ</mi><mi>I</mi></msub><mo>,</mo><msub><mi>Ψ</mi><mn>0</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>Ψ</mi><mrow><mi>I</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>σ</mi><mn>0</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>σ</mi><mrow><mi>I</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>τ</mi><mn>0</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>τ</mi><mrow><mi>I</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\Theta = (\Phi_0,...,\Phi_I,
\Psi_0,...,\Psi_{I-1},\sigma_0,...,\sigma_{I-1},\tau_0,...,\tau_{I-1}</annotation></semantics></math>
we have
<ul>
<li>the random vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ξ</mi><mrow><mn>0</mn><mo>,</mo><mn>0</mn></mrow></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>ξ</mi><mrow><mi>I</mi><mo>,</mo><mi>I</mi></mrow></msub><mo>,</mo><msub><mi>ζ</mi><mrow><mn>0</mn><mo>,</mo><mn>0</mn></mrow></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>ζ</mi><mrow><mi>I</mi><mo>,</mo><mi>I</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\xi_{0,0},...,\xi_{I,I}, \zeta_{0,0},...,\zeta_{I,I-1})</annotation></semantics></math>
has multivariate Gaussian distribution with uncorrelated components
given by $$
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Φ</mi><mi>j</mi></msub><mo>,</mo><msubsup><mi>σ</mi><mi>j</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation*}
\xi_{i,j} \sim N(\Phi_j,\sigma^2_j),
\end{equation*}</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ζ</mi><mrow><mi>k</mi><mo>,</mo><mi>l</mi></mrow></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Ψ</mi><mi>l</mi></msub><mo>,</mo><msubsup><mi>τ</mi><mi>l</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>;</mo></mrow><annotation encoding="application/x-tex">\begin{equation*}
\zeta_{k,l} \sim N(\Psi_l,\tau^2_l);
\end{equation*}</annotation></semantics></math>
</li>
<li>cumulative payments are given by the recursion
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>P</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ξ</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation*}
P_{i,j} = P_{i,j-1} \exp(\xi_{i,j}),
\end{equation*}</annotation></semantics></math> $$ with initial value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>i</mi><mo>,</mo><mn>0</mn></mrow></msub><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ξ</mi><mrow><mi>i</mi><mo>,</mo><mn>0</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P_{i,0} = \exp (\xi_{i,0})</annotation></semantics></math>;</li>
<li>incurred losses
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">I_{i,j}</annotation></semantics></math>
are given by the backwards recursion
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>I</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msub><mi>ζ</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\begin{equation*}
I_{i,j-1} = I_{i,j} \exp(-\zeta_{i,j-1}),
\end{equation*}
 </annotation></semantics></math> with initial value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mrow><mi>i</mi><mo>,</mo><mi>I</mi></mrow></msub><mo>=</mo><msub><mi>P</mi><mrow><mi>i</mi><mo>,</mo><mi>I</mi></mrow></msub></mrow><annotation encoding="application/x-tex">I_{i,I}=P_{i,I}</annotation></semantics></math>.</li>
</ul>
</li>
<li>The components of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Θ</mi><annotation encoding="application/x-tex">\Theta</annotation></semantics></math>
are independent and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mi>j</mi></msub><mo>,</mo><msub><mi>τ</mi><mi>j</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sigma_j,\tau_j &gt; 0</annotation></semantics></math>
for all j.</li>
</ul>
</div>
<div class="section level4">
<h4 id="parameter-estimation">Parameter estimation<a class="anchor" aria-label="anchor" href="#parameter-estimation"></a>
</h4>
<p>Parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Θ</mi><annotation encoding="application/x-tex">\Theta</annotation></semantics></math>
in the model are in general not known and need to be estimated from
observations. They are estimated in a Bayesian framework. In the
Bayesian PIC model they assume that the previous assumptions hold true
with deterministic
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mn>0</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>σ</mi><mi>J</mi></msub></mrow><annotation encoding="application/x-tex">\sigma_0,...,\sigma_J</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>τ</mi><mn>0</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>τ</mi><mrow><mi>J</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\tau_0,...,\tau_{J-1}</annotation></semantics></math>
and</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Φ</mi><mi>m</mi></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ϕ</mi><mi>m</mi></msub><mo>,</mo><msubsup><mi>s</mi><mi>m</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\begin{equation*}
\Phi_m \sim N(\phi_m,s^2_m),
\end{equation*}
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Ψ</mi><mi>n</mi></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ψ</mi><mi>n</mi></msub><mo>,</mo><msubsup><mi>t</mi><mi>n</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\begin{equation*}
\Psi_n \sim N(\psi_n,t^2_n).
\end{equation*}
</annotation></semantics></math></p>
<p>This is not a full Bayesian approach but has the advantage to give
analytical expressions for the posterior distributions and the
prediction uncertainty.</p>
<p>The Paid-incurred Chain model is implemented in the
<code>ChainLadder</code> package via the function
<code>PaidIncurredChain</code>. As an example we apply the function to
the USAA paid and incurred triangles:</p>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PIC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PaidIncurredChain.html">PaidIncurredChain</a></span><span class="op">(</span><span class="va">USAApaid</span>, <span class="va">USAAincurred</span><span class="op">)</span></span>
<span><span class="va">PIC</span></span></code></pre></div>
<pre><code>$Ult.Loss.Origin
         [,1]
 [1,]  983113
 [2,] 1078697
 [3,] 1145761
 [4,] 1245171
 [5,] 1371964
 [6,] 1433857
 [7,] 1415964
 [8,] 1410065
 [9,] 1320415

$Ult.Loss
[1] 11405008

$Res.Origin
          [,1]
 [1,]    965.3
 [2,]   3159.6
 [3,]   7386.4
 [4,]  18521.4
 [5,]  47232.4
 [6,] 113727.4
 [7,] 230663.7
 [8,] 443903.3
 [9,] 778393.5

$Res.Tot
[1] 1643953

$s.e.
[1] 113940</code></pre>
<p>We can access the reserves by origin year via</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PIC</span><span class="op">$</span><span class="va">Res.Origin</span></span></code></pre></div>
<pre><code>          [,1]
 [1,]    965.3
 [2,]   3159.6
 [3,]   7386.4
 [4,]  18521.4
 [5,]  47232.4
 [6,] 113727.4
 [7,] 230663.7
 [8,] 443903.3
 [9,] 778393.5</code></pre>
<p>and the total reserve via</p>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PIC</span><span class="op">$</span><span class="va">Res.Tot</span></span></code></pre></div>
<pre><code>[1] 1643953</code></pre>
<p><code>s.e.</code> is the square root of mean square error of
prediction for the total ultimate loss.</p>
<p>It’s important to notice that the model is implemented in the special
case of non-informative priors for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Φ</mi><mi>m</mi></msub><annotation encoding="application/x-tex">\Phi_m</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Ψ</mi><mi>n</mi></msub><annotation encoding="application/x-tex">\Psi_n</annotation></semantics></math>;
this means that we let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>s</mi><mi>m</mi><mn>2</mn></msubsup><mo>→</mo><mi>∞</mi></mrow><annotation encoding="application/x-tex">s^2_m \to \infty</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>t</mi><mi>n</mi><mn>2</mn></msubsup><mo>→</mo><mi>∞</mi></mrow><annotation encoding="application/x-tex">t^2_n \to \infty</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level3">
<h3 id="one-year-claims-development-result">One year claims development result<a class="anchor" aria-label="anchor" href="#one-year-claims-development-result"></a>
</h3>
<p>The stochastic claims reserving methods considered above predict the
lower (unknown) triangle and assess the uncertainty of this prediction.
For instance, Mack’s uncertainty formula quantifies the total prediction
uncertainty of the chain-ladder predictor over the entire run-off of the
outstanding claims. Modern solvency considerations, such as Solvency II,
require a second view of claims reserving uncertainty. This second view
is a short-term view because it requires assessments of the one-year
changes of the claims predictions when one updates the available
information at the end of each accounting year. At time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>≥</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">t\ge n</annotation></semantics></math>
we have information</p>
<p><span class="math display">$$
\begin{equation*}
{\cal D}_{t}
= \left\{C_{i,k};~{i+k \le t+1} \right\}.
\end{equation*}
$$</span></p>
<p>This motivates the following sequence of predictors for the ultimate
claim
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mrow><mi>i</mi><mo>,</mo><mi>K</mi></mrow></msub><annotation encoding="application/x-tex">C_{i,K}</annotation></semantics></math>
at times
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>≥</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">t\ge n</annotation></semantics></math></p>
<p><span class="math display">$$
\begin{equation*}
\widehat{C}^{(t)}_{i,K}= \mathbb{E}[C_{i,K}|{\cal D}_t].
\end{equation*}
$$</span></p>
<p>The one year claims development results (CDR), see Merz-Wüthrich ,
consider the changes in these one year updates, that is,</p>
<p><span class="math display">$$
\begin{equation*}
{\rm CDR}_{i,t+1}
=\widehat{C}^{(t)}_{i,K}-\widehat{C}^{(t+1)}_{i,K}.
\end{equation*}
$$</span></p>
<p>The tower property of conditional expectation implies that the CDRs
are on average 0, that is, <span class="math inline">$\mathbb{E}[{\rm
CDR}_{i,t+1}|{\cal D}_t]=0$</span> and the Merz-Wüthrich formula <span class="citation">(Michael Merz and Wüthrich 2008a)</span>, <span class="citation">(Michael Merz and Wüthrich 2014)</span> assesses the
uncertainty of these predictions measured by the following conditional
mean square error of prediction (MSEP)</p>
<p><span class="math display">$$
\begin{equation*}
{\rm msep}_{{\rm CDR}_{i,t+1}|{\cal D}_t}(0)
= \mathbb{E} \left[\left.\left({\rm CDR}_{i,t+1}-0\right)^2
\right|{\cal D}_t \right].
\end{equation*}
$$</span></p>
<p>The major difficulty in the evaluation of the conditional MSEP is the
quantification of parameter estimation uncertainty.</p>
<div class="section level4">
<h4 id="cdr-functions">CDR functions<a class="anchor" aria-label="anchor" href="#cdr-functions"></a>
</h4>
<p>The one year claims development result (CDR) can be estimate via the
generic <code>CDR</code> function for objects of
<code>MackChainLadder</code> and <code>BootChainLadder</code>.</p>
<p>Further, the <code>tweedieReserve</code> function offers also the
option to estimate the one year CDR, by setting the argument
<code>rereserving=TRUE</code>.</p>
<p>For example, to reproduce the results of <span class="citation">(Michael Merz and Wüthrich 2014)</span> use:</p>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MackChainLadder.html">MackChainLadder</a></span><span class="op">(</span><span class="va">MW2014</span>, est.sigma<span class="op">=</span><span class="st">"Mack"</span><span class="op">)</span></span>
<span><span class="va">cdrM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CDR.html">CDR</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cdrM</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code>         IBNR CDR(1)S.E. Mack.S.E.
1         0.0        0.0       0.0
2         1.0        0.4       0.4
3        10.1        2.5       2.6
4        21.2       16.7      16.9
5       117.7      156.4     157.3
6       223.3      137.7     207.2
7       361.8      171.2     261.9
8       469.4       70.3     292.3
9       653.5      271.6     390.6
10     1008.8      310.1     502.1
11     1011.9      103.4     486.1
12     1406.7      632.6     806.9
13     1492.9      315.0     793.9
14     1917.6      406.1     891.7
15     2458.2      285.2     916.5
16     3384.3      668.2    1106.1
17     9596.6      733.2    1295.7
Total 24134.9     1842.9    3233.7</code></pre>
<p>To review the full claims development picture set the argument
<code>dev="all"</code>:</p>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdrAll</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CDR.html">CDR</a></span><span class="op">(</span><span class="va">M</span>,dev<span class="op">=</span><span class="st">"all"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cdrAll</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code>         IBNR CDR(1)S.E. CDR(2)S.E. CDR(3)S.E. CDR(4)S.E. CDR(5)S.E. CDR(6)S.E.
1         0.0        0.0        0.0        0.0        0.0        0.0        0.0
2         1.0        0.4        0.0        0.0        0.0        0.0        0.0
3        10.1        2.5        0.4        0.0        0.0        0.0        0.0
4        21.2       16.7        2.4        0.3        0.0        0.0        0.0
5       117.7      156.4       16.4        2.4        0.3        0.0        0.0
6       223.3      137.7      154.0       16.1        2.3        0.3        0.0
7       361.8      171.2      131.0      148.0       15.5        2.2        0.3
8       469.4       70.3      185.0      141.8      160.9       16.8        2.4
9       653.5      271.6       61.8      178.0      136.9      155.7       16.3
10     1008.8      310.1      274.6       59.0      180.4      138.6      158.1
11     1011.9      103.4      293.0      260.0       53.0      170.9      131.4
12     1406.7      632.6      102.3      302.2      268.7       52.8      176.6
13     1492.9      315.0      572.1       86.6      273.0      242.8       45.4
14     1917.6      406.1      313.3      573.0       84.4      273.1      243.1
15     2458.2      285.2      395.5      305.3      560.8       80.1      267.1
16     3384.3      668.2      271.7      380.2      293.3      540.6       75.7
17     9596.6      733.2      645.4      261.0      367.0      282.8      522.9
Total 24134.9     1842.9     1485.1     1208.3     1071.1      901.1      785.3
      CDR(7)S.E. CDR(8)S.E. CDR(9)S.E. CDR(10)S.E. CDR(11)S.E. CDR(12)S.E.
1            0.0        0.0        0.0         0.0         0.0         0.0
2            0.0        0.0        0.0         0.0         0.0         0.0
3            0.0        0.0        0.0         0.0         0.0         0.0
4            0.0        0.0        0.0         0.0         0.0         0.0
5            0.0        0.0        0.0         0.0         0.0         0.0
6            0.0        0.0        0.0         0.0         0.0         0.0
7            0.0        0.0        0.0         0.0         0.0         0.0
8            0.3        0.0        0.0         0.0         0.0         0.0
9            2.3        0.3        0.0         0.0         0.0         0.0
10          16.6        2.4        0.3         0.0         0.0         0.0
11         150.4       15.7        2.3         0.3         0.0         0.0
12         135.8      155.6       16.3         2.3         0.3         0.0
13         159.7      122.9      141.1        14.8         2.1         0.3
14          44.1      159.9      123.0       141.4        14.8         2.1
15         237.9       42.3      156.4       120.4       138.5        14.5
16         257.3      229.3       39.9       150.8       116.1       133.6
17          71.8      248.8      221.7        38.1       145.9       112.3
Total      525.2      476.3      366.4       269.3       245.0       180.4
      CDR(13)S.E. CDR(14)S.E. CDR(15)S.E. CDR(16)S.E. CDR(17)S.E. Mack.S.E.
1             0.0         0.0         0.0         0.0           0       0.0
2             0.0         0.0         0.0         0.0           0       0.4
3             0.0         0.0         0.0         0.0           0       2.6
4             0.0         0.0         0.0         0.0           0      16.9
5             0.0         0.0         0.0         0.0           0     157.3
6             0.0         0.0         0.0         0.0           0     207.2
7             0.0         0.0         0.0         0.0           0     261.9
8             0.0         0.0         0.0         0.0           0     292.3
9             0.0         0.0         0.0         0.0           0     390.6
10            0.0         0.0         0.0         0.0           0     502.1
11            0.0         0.0         0.0         0.0           0     486.1
12            0.0         0.0         0.0         0.0           0     806.9
13            0.0         0.0         0.0         0.0           0     793.9
14            0.3         0.0         0.0         0.0           0     891.7
15            2.1         0.3         0.0         0.0           0     916.5
16           14.0         2.0         0.3         0.0           0    1106.1
17          129.3        13.5         1.9         0.3           0    1295.7
Total       130.1        13.7         2.0         0.3           0    3233.7</code></pre>
<p>See the help files to <code>CDR</code> and
<code>tweedieReserve</code> for more details.</p>
</div>
</div>
<div class="section level3">
<h3 id="model-validation-with-tweediereserve">Model Validation with tweedieReserve<a class="anchor" aria-label="anchor" href="#model-validation-with-tweediereserve"></a>
</h3>
<p>Model validation is one of the key activities when an insurance
company goes through the Internal Model Approval Process with the
regulator. This section gives some examples how the arguments of the
<code>tweedieReserve</code> function can be used to validate a
stochastic reserving model. The argument <code>design.type</code> allows
us to test different regression structures. The classic over-dispersed
Poisson (ODP) model uses the following structure:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>∽</mo><mrow><mi>𝚊</mi><mi>𝚜</mi><mi mathvariant="monospace">.</mi><mi>𝚏</mi><mi>𝚊</mi><mi>𝚌</mi><mi>𝚝</mi><mi>𝚘</mi><mi>𝚛</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>O</mi><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mi>𝚊</mi><mi>𝚜</mi><mi mathvariant="monospace">.</mi><mi>𝚏</mi><mi>𝚊</mi><mi>𝚌</mi><mi>𝚝</mi><mi>𝚘</mi><mi>𝚛</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\begin{equation*}
Y \backsim \mathtt{as.factor}(OY) + \mathtt{as.factor}(DY),
\end{equation*}
</annotation></semantics></math></p>
<p>(i.e. <code>design.type=c(1,1,0)</code>). This allows, together with
the log link, to achieve the same results of the (volume weighted)
chain-ladder model, thus the same model implied assumptions. A common
model shortcoming is when the residuals plotted by calendar period start
to show a pattern, which chain-ladder isn’t capable to model. In order
to overcome this, the user could be then interested to change the
regression structure in order to try to strip out these patterns <span class="citation">(Gigante and Sigalotti 2005)</span>. For example, a
regression structure like:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>∽</mo><mrow><mi>𝚊</mi><mi>𝚜</mi><mi mathvariant="monospace">.</mi><mi>𝚏</mi><mi>𝚊</mi><mi>𝚌</mi><mi>𝚝</mi><mi>𝚘</mi><mi>𝚛</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mi>𝚊</mi><mi>𝚜</mi><mi mathvariant="monospace">.</mi><mi>𝚏</mi><mi>𝚊</mi><mi>𝚌</mi><mi>𝚝</mi><mi>𝚘</mi><mi>𝚛</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\begin{equation*}
Y \backsim \mathtt{as.factor}(DY) + \mathtt{as.factor}(CY),
\end{equation*}
</annotation></semantics></math></p>
<p>i.e. <code>design.type=c(0,1,1)</code> could be considered instead.
This approach returns the same results of the arithmetic separation
method, modelling explicitly inflation parameters between consequent
calendar periods. Another interesting assumption is the assumed
underlying distribution. The ODP model assumes the following:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>∽</mo><mi>O</mi><mi>D</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>m</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>,</mo><mi>ϕ</mi><mo>⋅</mo><msub><mi>m</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\begin{equation*}
P_{i,j} \backsim ODP(m_{i,j},\phi \cdot m_{i,j}),
\end{equation*}
</annotation></semantics></math></p>
<p>which is a particular case of a Tweedie distribution, with
<code>p</code> parameter equals to 1. Generally speaking, for any random
variable Y that obeys a Tweedie distribution, the variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝕍</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{V}[Y]</annotation></semantics></math>
relates to the mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[Y]</annotation></semantics></math>
by the following law:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝕍</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>a</mi><mo>⋅</mo><mi>𝔼</mi><msup><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="true" form="postfix">]</mo></mrow><mi>p</mi></msup><mo>,</mo></mrow><annotation encoding="application/x-tex">
\begin{equation*}
\mathbb{V}[Y] = a \cdot \mathbb{E}[Y]^p,
\end{equation*}
</annotation></semantics></math></p>
<p>where <code>a</code> and <code>p</code> are positive constants. The
user is able to test different <code>p</code> values through the
<code>var.power</code> function argument. Besides, in order to validate
the Tweedie’s <code>p</code> parameter, it could be interesting to plot
the likelihood profile at defined <code>p</code> values (through the
<code>p.check</code> argument) for a given a dataset and a regression
structure. This could be achieved setting the <code>p.optim=TRUE</code>
argument.</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">p_profile</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tweedieReserve.html">tweedieReserve</a></span><span class="op">(</span><span class="va">MW2008</span>, p.optim<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>   p.check<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1.1</span>,<span class="fl">1.2</span>,<span class="fl">1.3</span>,<span class="fl">1.4</span>,<span class="fl">1.5</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>   design.type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>   rereserving<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>   bootstrap<span class="op">=</span><span class="fl">0</span>,</span>
<span>   progressBar<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># 0 1.1 1.2 1.3 1.4 1.5 2 3</span></span>
<span><span class="co"># ........Done.</span></span>
<span><span class="co"># MLE of p is between 0 and 1, which is impossible.</span></span>
<span><span class="co"># Instead, the MLE of p has been set to NA .</span></span>
<span><span class="co"># Please check your data and the call to tweedie.profile().</span></span>
<span><span class="co"># Error in if ((xi.max == xi.vec[1]) | (xi.max == xi.vec[length(xi.vec)])) { :</span></span>
<span><span class="co"># missing value where TRUE/FALSE needed</span></span></code></pre></div>
<p><img src="tweedieReserve.png" width="60%" style="display: block; margin: auto;"></p>
<p>This example shows that the MLE of p seems to be between 0 and 1,
which is not possible as Tweedie models aren’t defined for 0 &lt; p &lt;
1, thus the Error message. But, despite this, we can conclude that
overall a value <code>p=1</code> could be reasonable for this dataset
and the chosen regression function, as it seems to be near the MLE.
Other sensitivities could be run on:</p>
<ul>
<li>Bootstrap type (parametric / semi-parametric), via the
<code>bootstrap</code> argument</li>
<li>Bias adjustment (if using semi-parametric bootstrap), via the
<code>boot.adj</code> argument</li>
</ul>
<p>Please refer to <code><a href="../reference/tweedieReserve.html">help(tweedieReserve)</a></code> for additional
information.</p>
</div>
<div class="section level3">
<h3 id="further-resources">Further resources<a class="anchor" aria-label="anchor" href="#further-resources"></a>
</h3>
<p>For a full Bayesian approach to claims reserving in R with Stan using
the brms package see <a href="https://compartmentalmodels.gitlab.io/researchpaper/index.html" class="external-link">‘Hierarchical
Compartmental Reserving Models’</a> <span class="citation">(Gesmann and
Morris 2020)</span>.</p>
<p>Other useful documents and resources to get started with R in the
context of actuarial work:</p>
<ul>
<li>Introduction to R for Actuaries <span class="citation">(De Silva
2006)</span>.</li>
<li>Computational Actuarial Science with R <span class="citation">(Charpentier 2014)</span>
</li>
<li>Modern Actuarial Risk Theory – Using R <span class="citation">(Kaas
et al. 2001)</span>
</li>
<li>An Actuarial Toolkit <span class="citation">(Maynard et al.
2006)</span>
</li>
<li>Insurance Data Science conference: <a href="https://insurancedatascience.org" class="external-link">https://insurancedatascience.org</a>
</li>
</ul>
<div class="section level4">
<h4 id="other-insurance-related-r-packages">Other insurance related R packages<a class="anchor" aria-label="anchor" href="#other-insurance-related-r-packages"></a>
</h4>
<p>Below is a list of further R packages in the context of insurance.
The list is by no-means complete, and the CRAN Task Views <a href="https://CRAN.R-project.org/view=Finance" class="external-link">‘Empirical Finance’</a>
and <a href="https://CRAN.R-project.org/view=Distributions" class="external-link">‘Probability
Distributions’</a> will provide links to additional resources.</p>
<ul>
<li>cplm: Likelihood-based and Bayesian methods for fitting Tweedie
compound Poisson linear models <span class="citation">(Zhang
2012)</span>.</li>
<li>DCL: Claims Reserving under the Double Chain-Ladder Model.
Statistical modelling and forecasting in claims reserving in non-life
insurance under the Double Chain-Ladder framework by <span class="citation">(Miranda, Nielsen, and Verrall 2012)</span>.</li>
<li>actuar: Loss distributions modelling, risk theory (including ruin
theory), simulation of compound hierarchical models and credibility
theory <span class="citation">(Dutang, Goulet, and Pigeon
2008)</span>.</li>
<li>fitdistrplus: Help to fit of a parametric distribution to
non-censored or censored data <span class="citation">(Delignette-Muller
et al. 2010)</span>.</li>
<li>mondate: R package to keep track of dates in terms of months <span class="citation">(Murphy 2021)</span>.</li>
<li>lifecontingencies: Package to perform actuarial evaluation of life
contingencies <span class="citation">(Spedicato 2022)</span>.</li>
<li>raw: R Actuarial Workshops, several sets of publicly available data
of interest to non-life actuaries <span class="citation">(Fannin
2021)</span>
</li>
<li>SPLICE: Synthetic Paid Loss and Incurred Cost Experience (SPLICE)
Simulator <span class="citation">(Avanzi, Taylor, and Wang
2021)</span>
</li>
<li>SynthETIC: Synthetic Experience Tracking Insurance Claims <span class="citation">(Avanzi et al. 2021)</span>
</li>
<li>NetSimR: Actuarial Functions for Non-Life Insurance Modelling <span class="citation">(Parizas 2019)</span>
</li>
</ul>
<p>No longer on CRAN:</p>
<ul>
<li>lossDev: A Bayesian time series loss development model. Features
include skewed-t distribution with time-varying scale parameter,
Reversible Jump MCMC for determining the functional form of the
consumption path, and a structural break in this path <span class="citation">(Laws and Schmid 2011)</span>.</li>
<li>favir: Formatted Actuarial Vignettes in R. FAViR lowers the learning
curve of the R environment. It is a series of peer-reviewed Sweave
papers that use a consistent style <span class="citation">(Escoto
2011)</span>.</li>
<li>MRMR: Multivariate Regression Models for Reserving <span class="citation">(Fannin 2013)</span>.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-SPLICE" class="csl-entry">
Avanzi, Benjamin, Greg Taylor, and Melantha Wang. 2021. <em>SPLICE:
Synthetic Paid Loss and Incurred Cost Experience (SPLICE)
Simulator</em>. <a href="https://CRAN.R-project.org/package=SPLICE" class="external-link">https://CRAN.R-project.org/package=SPLICE</a>.
</div>
<div id="ref-SynthETIC" class="csl-entry">
Avanzi, Benjamin, Greg Taylor, Melantha Wang, and Bernard Wong. 2021.
<span>“<span>SynthETIC</span>: <span>An</span> Individual Insurance
Claim Simulator with Feature Control.”</span> <em>Insurance: Mathematics
and Economics</em> 100 (September): 296–308. <a href="https://doi.org/10.1016/j.insmatheco.2021.06.004" class="external-link">https://doi.org/10.1016/j.insmatheco.2021.06.004</a>.
</div>
<div id="ref-Buchwalder:2006" class="csl-entry">
Buchwalder, M., H. Bühlmann, M. Merz, and M. V Wüthrich. 2006.
<span>“The Mean Square Error of Prediction in the Chain Ladder Reserving
Method (Mack and Murphy Revisited).”</span> <em>North American Actuarial
Journal</em> 36: 521–42.
</div>
<div id="ref-CASwR2014" class="csl-entry">
Charpentier, Arthur, ed. 2014. <em>Computational <span>A</span>ctuarial
<span>S</span>cience with <span>R</span></em>. Chapman; Hall/CRC.
</div>
<div id="ref-Clark2003" class="csl-entry">
Clark, David R. 2003. <em><span>LDF</span> Curve-Fitting and Stochastic
Reserving: A Maximum Likelihood Approach</em>. Casualty Actuarial
Society; <a href="https://www.casact.org/sites/default/files/database/forum_03fforum_03ff041.pdf" class="external-link uri">https://www.casact.org/sites/default/files/database/forum_03fforum_03ff041.pdf</a>.
</div>
<div id="ref-DeSilva2006" class="csl-entry">
De Silva, Nigel. 2006. <span>“An Introduction to r: Examples for
Actuaries.”</span> Actuarial Toolkit Working Party; <a href="http://toolkit.pbworks.com/RToolkit" class="external-link uri">http://toolkit.pbworks.com/RToolkit</a>.
</div>
<div id="ref-Delignette-MullerPouillotDenisDutang2011" class="csl-entry">
Delignette-Muller, Marie Laure, Regis Pouillot, Jean-Baptiste Denis, and
Christophe Dutang. 2010. <em>Fitdistrplus: Help to Fit of a Parametric
Distribution to Non-Censored or Censored Data</em>.
</div>
<div id="ref-DutangGouletPigeon2008" class="csl-entry">
Dutang, C, V. Goulet, and M. Pigeon. 2008. <span>“Actuar: An
<span>R</span> Package for Actuarial Science.”</span> <em>Journal of
Statistical Software</em> 25 (7).
</div>
<div id="ref-EnglandVerrall2002" class="csl-entry">
England, Peter, and Richard Verrall. 2002. <span>“Stochastic Claims
Reserving in General Insurance.”</span> <em>British Actuarial
Journal</em> 8: 443–544.
</div>
<div id="ref-Escoto2011" class="csl-entry">
Escoto, Benedict. 2011. <em>Favir: Formatted Actuarial Vignettes in
r</em>. 0.5–1st ed. <a href="https://github.com/cran/favir" class="external-link uri">https://github.com/cran/favir</a>.
</div>
<div id="ref-MRMR" class="csl-entry">
Fannin, Brian A. 2013. <em>MRMR: Multivariate Regression Models for
Reserving</em>. <a href="https://CRAN.R-project.org/package=MRMR" class="external-link">https://CRAN.R-project.org/package=MRMR</a>.
</div>
<div id="ref-raw" class="csl-entry">
———. 2021. <em>Raw: R Actuarial Workshops</em>. <a href="https://CRAN.R-project.org/package=raw" class="external-link">https://CRAN.R-project.org/package=raw</a>.
</div>
<div id="ref-gesmann2014claims" class="csl-entry">
Gesmann, Markus. 2014. <span>“Claims Reserving and
<span>IBNR</span>.”</span> In <em>Computational <span>A</span>ctuarial
<span>S</span>cience with <span>R</span></em>, 545–84. Chapman;
Hall/CRC.
</div>
<div id="ref-gesmann_morris" class="csl-entry">
Gesmann, Markus, and Jake Morris. 2020. <em>Hierarchical Compartmental
Reserving Models</em>. Casualty Actuarial Society; <a href="https://www.casact.org/sites/default/files/2021-02/compartmental-reserving-models-gesmannmorris0820.pdf" class="external-link uri">https://www.casact.org/sites/default/files/2021-02/compartmental-reserving-models-gesmannmorris0820.pdf</a>.
</div>
<div id="ref-GiganteSigalotti2005" class="csl-entry">
Gigante, and Sigalotti. 2005. <span>“Model Risk in Claims Reserving with
GLM.”</span> <em>Giornale Dell IIA</em> LXVIII: 55–87.
</div>
<div id="ref-Gravelsons2009" class="csl-entry">
Gravelsons, Brian, Matthew Ball, Dan Beard, Robert Brooks, Naomi
Couchman, Brian Gravelsons, Charlie Kefford, et al. 2009. <span>“B12: UK
Asbestos Working Party Update 2009.”</span> <a href="https://www.actuaries.org.uk/system/files/documents/pdf/b12asbestoswp.pdf" class="external-link uri">https://www.actuaries.org.uk/system/files/documents/pdf/b12asbestoswp.pdf</a>.
</div>
<div id="ref-systemfit" class="csl-entry">
Henningsen, Arne, and Jeff D. Hamann. 2007. <span>“Systemfit: A Package
for Estimating Systems of Simultaneous Equations in r.”</span>
<em>Journal of Statistical Software</em> 23 (4): 1–40. <a href="https://doi.org/10.18637/jss.v023.i04" class="external-link">https://doi.org/10.18637/jss.v023.i04</a>.
</div>
<div id="ref-KaassGoovaertsDhaeneDenuit2001" class="csl-entry">
Kaas, R., M. Goovaerts, J. Dhaene, and M. Denuit. 2001. <em>Modern
Actuarial Risk Theory</em>. Dordrecht: Kluwer <span>A</span>cademic
<span>P</span>ublishers.
</div>
<div id="ref-LawsSchmid2011" class="csl-entry">
Laws, Christopher W., and Frank A. Schmid. 2011. <em>lossDev: Robust
Loss Development Using MCMC</em>. <a href="https://lossdev.r-forge.r-project.org" class="external-link uri">https://lossdev.r-forge.r-project.org</a>.
</div>
<div id="ref-ClaimsReservingWorkingParty:2002" class="csl-entry">
Lyons, Graham, Will Forster, Paul Kedney, Ryan Warren, and Helen
Wilkinson. 2002. <em>Claims Reserving Working Party Paper</em>.
Institute of Actuaries.
</div>
<div id="ref-Mack_distributionfree1993" class="csl-entry">
Mack, Thomas. 1993. <span>“Distribution-Free Calculation of the Standard
Error of Chain Ladder Reserve Estimates.”</span> <em>ASTIN Bulletin</em>
23: 213–25.
</div>
<div id="ref-Mack1999" class="csl-entry">
———. 1999. <span>“The Standard Error of Chain Ladder Reserve Estimates:
Recursive Calculation and Inclusion of a Tail Factor.”</span> <em>Astin
Bulletin</em> Vol. 29 (2): 361–266.
</div>
<div id="ref-MaynardDeSilvaHollowayGesmannLauHarnett2006" class="csl-entry">
Maynard, Trevor, Nigel De Silva, Richard Holloway, Markus Gesmann, Sie
Lau, and John Harnett. 2006. <span>“An Actuarial Toolkit. Introducing
<span>T</span>he <span>T</span>oolkit <span>M</span>anifesto.”</span> <a href="https://www.actuaries.org.uk/system/files/documents/pdf/actuarial-toolkit.pdf" class="external-link uri">https://www.actuaries.org.uk/system/files/documents/pdf/actuarial-toolkit.pdf</a>.
</div>
<div id="ref-MW2008" class="csl-entry">
Merz, Michael, and Mario V. Wüthrich. 2008a. <span>“Modelling the Claims
Development Result for Solvency Purposes.”</span> <em>CAS E-Forum</em>
Fall: 542–68.
</div>
<div id="ref-MerzWuthrich2008" class="csl-entry">
———. 2008b. <span>“Prediction Error of the Multivariate Chain Ladder
Reserving Method.”</span> <em>North American Actuarial Journal</em> 12:
175–97.
</div>
<div id="ref-MerzWuthrich2014" class="csl-entry">
———. 2014. <span>“Laims Run-Off Uncertainty: The Full Picture.”</span>
<em>SSRN Manuscript</em> 2524352.
</div>
<div id="ref-MerzWuthrich:2010" class="csl-entry">
Merz, M., and M. Wüthrich. 2010. <span>“Paid-Incurred Chain Claims
Reserving Method.”</span> <em>Insurance: Mathematics and Economics</em>
46(3): 568–79.
</div>
<div id="ref-Michaels2002" class="csl-entry">
Michaels, Darren. 2002. <span>“<span>APH</span>: How the Love Carnal and
Silicone Implants Nearly Destroyed <span>L</span>loyd’s
(Slides).”</span> Institute of Actuaries: <a href="https://www.actuaries.org.uk/system/files/documents/pdf/aph-how-love-canal-and-silicone-breasts.pdf" class="external-link uri">https://www.actuaries.org.uk/system/files/documents/pdf/aph-how-love-canal-and-silicone-breasts.pdf</a>.
</div>
<div id="ref-miranda_nielsen_verrall_2012" class="csl-entry">
Miranda, María Dolores Martínez, Jens Perch Nielsen, and Richard
Verrall. 2012. <span>“Double Chain Ladder.”</span> <em>ASTIN
Bulletin</em> 42 (1): 59–76. <a href="https://doi.org/10.2143/AST.42.1.2160712" class="external-link">https://doi.org/10.2143/AST.42.1.2160712</a>.
</div>
<div id="ref-DanielMurphy1994" class="csl-entry">
Murphy, Daniel. 1994. <span>“Unbiased Loss Development Factors.”</span>
<em>PCAS</em> 81: 154–222.
</div>
<div id="ref-Murphy2011" class="csl-entry">
———. 2021. <em>Mondate: Keep Track of Dates in Terms of Months</em>. <a href="https://CRAN.R-project.org/package=mondate" class="external-link uri">https://CRAN.R-project.org/package=mondate</a>.
</div>
<div id="ref-JamesOrr:2012" class="csl-entry">
Orr, James. 2012. <em><span>GIROC</span> Reserving Research
Workstream</em>. Institute of Actuaries.
</div>
<div id="ref-NetSimR" class="csl-entry">
Parizas, Yiannis. 2019. <span>“Escaping the Triangle.”</span> <em>The
Actuary Magazine</em> June.
</div>
<div id="ref-ProhlSchmidt2005" class="csl-entry">
Pröhl, Carsten, and Klaus D. Schmidt. 2005. <span>“Multivariate
Chain-Ladder.”</span> <em>Dresdner Schriften Zur
Versicherungsmathematik</em>.
</div>
<div id="ref-Quarg2004" class="csl-entry">
Quarg, Gerhard, and Thomas Mack. 2004. <span>“Munich Chain
Ladder.”</span> Munich Re Group.
</div>
<div id="ref-Rdata" class="csl-entry">
R Development Core Team. 2022a. <em>R Data Import/Export</em>. R
Foundation for Statistical Computing; <a href="https://cran.r-project.org/doc/manuals/R-data.pdf" class="external-link uri">https://cran.r-project.org/doc/manuals/R-data.pdf</a>.
</div>
<div id="ref-Radmin" class="csl-entry">
———. 2022b. <em>R Installation and Administration</em>. R Foundation for
Statistical Computing; <a href="https://cran.r-project.org/doc/manuals/R-admin.pdf" class="external-link uri">https://cran.r-project.org/doc/manuals/R-admin.pdf</a>.
</div>
<div id="ref-Schmidt2011" class="csl-entry">
Schmidt, Klaus D. 2017. <span>“A Bibliography on Loss Reserving.”</span>
https://tu-dresden.de/mn/math/stochastik/ressourcen/dateien/schmidt/dsvm/reserve.pdf.
</div>
<div id="ref-Spedicato2011" class="csl-entry">
Spedicato, Giorgio Alfredo. 2022. <em>Introduction to Lifecontingencies
Package</em>. 1.3.8 ed. StatisticalAdvisor Inc; <a href="https://CRAN.R-project.org/package=lifecontingencies/" class="external-link uri">https://CRAN.R-project.org/package=lifecontingencies/</a>.
</div>
<div id="ref-ZehnwirthBarnettProceedings" class="csl-entry">
Zehnwirth, Ben, and Glen Barnett. 2000. <span>“Best Estimates for
Reserves.”</span> <em>Proceedings of the CAS</em> LXXXVII (167).
</div>
<div id="ref-Zhang2010a" class="csl-entry">
Zhang, Yanwei. 2010. <span>“A General Multivariate Chain Ladder
Model.”</span> <em>Insurance: Mathematics and Economics</em> 46: 588–99.
</div>
<div id="ref-Zhang:2012" class="csl-entry">
———. 2012. <span>“Likelihood-Based and Bayesian Methods for Tweedie
Compound Poisson Linear Mixed Models.”</span> <em>Statistics and
Computing</em>.
</div>
<div id="ref-ZhangVanjaGuszcza2012" class="csl-entry">
Zhang, Yanwei, Vanja Dukic, and James Guszcza. 2012. <span>“A Bayesian
Nonlinear Model for Forecasting Insurance Loss Payments.”</span>
<em>Journal of the Royal Statistical Society, Series A</em> 175: 637–56.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Markus Gesmann, Daniel Murphy, Yanwei (Wayne) Zhang, Alessandro Carrato, Mario Wuthrich, Fabio Concina, Eric Dal Moro.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
