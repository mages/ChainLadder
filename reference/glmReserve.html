<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>GLM-based Reserving Model — glmReserve • ChainLadder</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="GLM-based Reserving Model — glmReserve"><meta name="description" content="This function implements loss reserving models within the generalized linear model framework. It takes accident year and development lag as mean predictors in estimating the ultimate loss reserves, and provides both analytical  and bootstrapping methods to compute the associated prediction errors. The bootstrapping approach also generates the full predictive distribution for loss reserves."><meta property="og:description" content="This function implements loss reserving models within the generalized linear model framework. It takes accident year and development lag as mean predictors in estimating the ultimate loss reserves, and provides both analytical  and bootstrapping methods to compute the associated prediction errors. The bootstrapping approach also generates the full predictive distribution for loss reserves."><meta property="og:image" content="http://mages.github.io/ChainLadder/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ChainLadder</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.20</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/ChainLadder.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mages/ChainLadder/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>GLM-based Reserving Model</h1>

      <div class="d-none name"><code>glmReserve.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function implements loss reserving models within the generalized linear model framework. It takes accident year and development lag as mean predictors in estimating the ultimate loss reserves, and provides both analytical  and bootstrapping methods to compute the associated prediction errors. The bootstrapping approach also generates the full predictive distribution for loss reserves.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">glmReserve</span><span class="op">(</span><span class="va">triangle</span>, var.power <span class="op">=</span> <span class="fl">1</span>, link.power <span class="op">=</span> <span class="fl">0</span>, cum <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>      mse.method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"formula"</span>, <span class="st">"bootstrap"</span><span class="op">)</span>,  nsim <span class="op">=</span> <span class="fl">1000</span>, nb <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-triangle">triangle<a class="anchor" aria-label="anchor" href="#arg-triangle"></a></dt>
<dd><p>An object of  class <code><a href="Triangles.html">triangle</a></code>.</p></dd>

  <dt id="arg-var-power">var.power<a class="anchor" aria-label="anchor" href="#arg-var-power"></a></dt>
<dd><p>The index (p) of the power variance function \(V(\mu)=\mu^p\). Default to <code>p = 1</code>, which is the over-dispersed Poisson model. If <code>NULL</code>, it will be assumed to be in <code>(1, 2)</code> and estimated using the <code>cplm</code> package.  See <code><a href="https://rdrr.io/pkg/statmod/man/tweedie.html" class="external-link">tweedie</a></code>.</p></dd>

  <dt id="arg-link-power">link.power<a class="anchor" aria-label="anchor" href="#arg-link-power"></a></dt>
<dd><p>The index of power link function. The default <code>link.power = 0</code> produces a log link. See <code><a href="https://rdrr.io/pkg/statmod/man/tweedie.html" class="external-link">tweedie</a></code>.</p></dd>

  <dt id="arg-cum">cum<a class="anchor" aria-label="anchor" href="#arg-cum"></a></dt>
<dd><p>A logical value indicating whether the input triangle is on the
  cumulative or the incremental scale. If <code>TRUE</code>, then
  <code>triangle</code> is assumed to be on the cumulative scale, and it will
  be converted to incremental losses internally before a GLM is fitted.</p></dd>

  <dt id="arg-mse-method">mse.method<a class="anchor" aria-label="anchor" href="#arg-mse-method"></a></dt>
<dd><p>A character indicating whether the prediction error should be computed analytically (<code>mse.method = "formula"</code>) or via bootstrapping (<code>mse.method = "bootstrap"</code>). Partial match is supported.</p></dd>

  <dt id="arg-nsim">nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>Number of simulations to be performed in the bootstrapping, with a default value of 1000.</p></dd>

  <dt id="arg-nb">nb<a class="anchor" aria-label="anchor" href="#arg-nb"></a></dt>
<dd><p>Whether the negative binomial distribution is used. If <code>true</code>, the arguments <code>var.power</code> and <code>link.power</code> are ignored and a negative binomial GLM is fitted using <code>glm.nb</code>.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments to be passed onto the function <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code> or <code><a href="https://rdrr.io/pkg/cplm/man/cpglm.html" class="external-link">cpglm</a></code> such as <code>contrasts</code> or <code>control</code>. It is important that <code>offset</code> and <code>weight</code> should not be specified. Otherwise, an error will be reported and the program will quit.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function takes an insurance loss triangle, converts it to incremental losses internally if necessary, transforms it to the long format (see <code>as.data.frame</code>) and fits the resulting loss data with a generalized linear model where the mean structure includes both the accident year and the development lag effects.
The distributions allowed are the exponential family that admits a power variance function, that is, \(V(\mu)=\mu^p\).
This subclass of distributions is usually called the Tweedie distribution and includes many commonly used distributions as special cases.</p>
<p>This function does not allow the user to specify the GLM options through the usual <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code> argument, but instead, it uses the <code><a href="https://rdrr.io/pkg/statmod/man/tweedie.html" class="external-link">tweedie</a></code> family internally and takes two arguments, <code>var.power</code> and <code>link.power</code>, through which the user still has full control of the distribution forms and link functions.
The argument <code>var.power</code> determines which specific distribution is to be used, and <code>link.power</code> determines the form of the link function.</p>
<p>When the Tweedie compound Poisson distribution <code>1 &lt; p &lt; 2</code> is to be used, the user has the option to specify <code>var.power = NULL</code>, where the variance power <code>p</code> will be estimated from the data using the <code>cplm</code> package. The <code>bcplm</code> function in the <code>cplm</code> package also has an example for the Bayesian compound Poisson loss reserving model.
See details in <code><a href="https://rdrr.io/pkg/statmod/man/tweedie.html" class="external-link">tweedie</a></code>, <code><a href="https://rdrr.io/pkg/cplm/man/cpglm.html" class="external-link">cpglm</a></code> and  <code><a href="https://rdrr.io/pkg/cplm/man/bcplm.html" class="external-link">bcplm</a></code>.</p>
<p><code>glmReserve</code> allows certain measures of exposures to be used in an offset term in the underlying GLM.
To do this, the user should not use the usual <code>offset</code> argument in <code>glm</code>.
Instead, one specifies the exposure measure for each accident year through the <code>exposure</code> attribute of <code>triangle</code>.
Make sure that these exposures are in the original scale (no log transformations for example).
If the vector is named, make sure the names coincide with the rownames/origin of the triangle.
If the vector is unnamed, make sure the exposures are in the order consistent with the accident years, <b>and the character rownames of the Triangle must be convertible to numeric.</b>
If the <code>exposure</code> attribute is not <code>NULL</code>, the <code>glmReserve</code> function will use these exposures, link-function-transformed, in the offset term of the GLM.
For example, if the link function is <code>log</code>, then the log of the exposure is used as the offset, not the original exposure.
See the examples below.
Moreover, the user MUST NOT supply the typical <code>offset</code> or <code>weight</code> as arguments in the list of additional arguments <code>...</code>. <code>offset</code> should be specified as above, while <code>weight</code> is not implemented (due to prediction reasons).</p>
<p>Two methods are available to assess the prediction error of the estimated loss reserves.
One is using the analytical formula (<code>mse.method = "formula"</code>) derived from the first-order Taylor approximation.
The other is using bootstrapping (<code>mse.method = "bootstrap"</code>) that reconstructs the triangle <code>nsim</code> times by sampling with replacement from the GLM (Pearson) residuals.
Each time a new triangle is formed, GLM is fitted and corresponding loss reserves are generated.
Based on these predicted mean loss reserves, and the model assumption about the distribution forms, realizations of the predicted values are generated via the <code>rtweedie</code> function.
Prediction errors as well as other uncertainty measures such as quantiles and predictive intervals can be calculated based on these samples.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The use of GLM in insurance loss reserving has many compelling aspects, e.g.,</p><ul><li><p>when over-dispersed Poisson model is used, it reproduces the estimates from Chain Ladder;</p></li>
<li><p>it provides a more coherent modeling framework than the Mack method;</p></li>
<li><p>all the relevant established statistical theory can be directly applied to perform hypothesis testing and diagnostic checking;</p></li>
</ul><p>However,  the user should be cautious of some of the key assumptions that underlie the GLM model, in order to determine whether this model is appropriate for the problem considered:</p><ul><li><p>the GLM model assumes no tail development, and it only projects losses to the latest time point of the observed data. To use a model that enables tail extrapolation, please consider the growth curve model <code><a href="ClarkLDF.html">ClarkLDF</a></code> or <code><a href="ClarkCapeCod.html">ClarkCapeCod</a></code>;</p></li>
<li><p>the model assumes that each incremental loss is independent of all the others.
  This assumption may not be valid in that cells from the same calendar year are usually correlated due to inflation or business operating factors;</p></li>
<li><p>the model tends to be over-parameterized, which may lead to inferior predictive performance.</p></li>
</ul><p>To solve these potential problems, many variants of the current basic GLM model have been proposed in the actuarial literature.
Some of these may be included in the future release.</p>
<p>Support of the negative binomial GLM was added since version 0.2.3.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The output is an object of class <code>"glmReserve"</code> that has the following components:</p>
<dl><dt>call</dt>
<dd><p>the matched call.</p></dd>

<dt>summary</dt>
<dd><p>A data frame containing the predicted loss reserve statistics. Similar to the summary statistics from <code>MackChainLadder</code>.</p></dd>

<dt>Triangle</dt>
<dd><p>The input triangle.</p></dd>

<dt>FullTriangle</dt>
<dd><p>The completed triangle, where empty cells in the original triangle are filled with model predictions.</p></dd>

<dt>model</dt>
<dd><p>The fitted GLM, a class of <code>"glm"</code> or <code>"cpglm"</code>. It is most convenient to work with this component when model fit information is wanted.</p></dd>

<dt>sims.par</dt>
<dd><p>a matrix of the simulated parameter values in the bootstrapping.</p></dd>

<dt>sims.reserve.mean</dt>
<dd><p>a matrix of the simulated mean loss reserves (without the process variance) for each year in the bootstrapping.</p></dd>

<dt>sims.par</dt>
<dd><p>a matrix of the simulated realizations of the loss reserves (with the process variance) for each year in the bootstrapping. This can be used to summarize the predictive uncertainty of the loss reserves.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>England P. and Verrall R. (1999). Analytic and bootstrap estimates of prediction errors in claims reserving. <em>Insurance: Mathematics and Economics</em>, 25, 281-293.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Wayne Zhang <a href="mailto:actuary_zhang@hotmail.com">actuary_zhang@hotmail.com</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See also <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code>, <code><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html" class="external-link">glm.nb</a></code>, <code><a href="https://rdrr.io/pkg/statmod/man/tweedie.html" class="external-link">tweedie</a></code>,  <code><a href="https://rdrr.io/pkg/cplm/man/cpglm.html" class="external-link">cpglm</a></code> and <code><a href="MackChainLadder.html">MackChainLadder</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">GenIns</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">GenIns</span> <span class="op">&lt;-</span> <span class="va">GenIns</span> <span class="op">/</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># over-dispersed Poisson: reproduce ChainLadder estimates</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">glmReserve</span><span class="op">(</span><span class="va">GenIns</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Latest Dev.To.Date  Ultimate  IBNR       S.E        CV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      5339.085  0.98251776  5434.085    95  110.0999 1.1589460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      4909.315  0.91262828  5379.315   470  216.0434 0.4596668</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      4588.268  0.86599394  5298.268   710  260.8721 0.3674255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      3873.311  0.79725464  4858.311   985  303.5500 0.3081726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      3691.712  0.72234788  5110.712  1419  375.0139 0.2642804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      3483.130  0.61527116  5661.130  2178  495.3780 0.2274463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      2864.498  0.42221223  6784.498  3920  789.9611 0.2015207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      1363.294  0.24162052  5642.294  4279 1046.5138 0.2445697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      344.014  0.06921791  4970.014  4626 1980.1014 0.4280375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> total 30456.627  0.61982291 49137.627 18681 2945.6609 0.1576822</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit1</span>, type <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span>   <span class="co"># extract the underlying glm</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glm(formula = value ~ factor(origin) + factor(dev), family = fam, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = ldaFit, offset = offset)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)       5.598649   0.172924  32.376  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(origin)2   0.331272   0.153537   2.158  0.03771 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(origin)3   0.321119   0.157719   2.036  0.04916 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(origin)4   0.305960   0.160736   1.903  0.06499 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(origin)5   0.219316   0.167970   1.306  0.19994    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(origin)6   0.270077   0.170756   1.582  0.12247    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(origin)7   0.372208   0.174451   2.134  0.03976 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(origin)8   0.553333   0.186525   2.967  0.00532 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(origin)9   0.368934   0.239181   1.542  0.13170    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(origin)10  0.242033   0.427562   0.566  0.57485    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(dev)2      0.912526   0.148850   6.131 4.65e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(dev)3      0.958831   0.152569   6.285 2.90e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(dev)4      1.025997   0.156883   6.540 1.33e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(dev)5      0.435276   0.183914   2.367  0.02344 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(dev)6      0.080057   0.214770   0.373  0.71152    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(dev)7     -0.006381   0.238290  -0.027  0.97878    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(dev)8     -0.394452   0.310289  -1.271  0.21180    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(dev)9      0.009378   0.320249   0.029  0.97680    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(dev)10    -1.379907   0.896690  -1.539  0.13258    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Dispersion parameter for Tweedie family taken to be 52.60193)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Null deviance: 10699  on 54  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance:  1903  on 36  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher Scoring iterations: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># which:</span></span></span>
<span class="r-in"><span><span class="co"># 1 Original triangle </span></span></span>
<span class="r-in"><span><span class="co"># 2 Full triangle </span></span></span>
<span class="r-in"><span><span class="co"># 3 Reserve distribution</span></span></span>
<span class="r-in"><span><span class="co"># 4 Residual plot</span></span></span>
<span class="r-in"><span><span class="co"># 5 QQ-plot</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot original triangle</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit1</span>, which <span class="op">=</span> <span class="fl">1</span>, xlab <span class="op">=</span> <span class="st">"dev year"</span>, ylab <span class="op">=</span> <span class="st">"cum loss"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="glmReserve-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot residuals </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit1</span>, which <span class="op">=</span> <span class="fl">4</span>, xlab <span class="op">=</span> <span class="st">"fitted values"</span>, ylab <span class="op">=</span> <span class="st">"residuals"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="glmReserve-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Gamma GLM:</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">glmReserve</span><span class="op">(</span><span class="va">GenIns</span>, var.power <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Latest Dev.To.Date  Ultimate  IBNR        S.E        CV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      5339.085  0.98287950  5432.085    93   45.16637 0.4856599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      4909.315  0.91654710  5356.315   447  160.55717 0.3591883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      4588.268  0.88248346  5199.268   611  177.62461 0.2907113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      3873.311  0.79610759  4865.311   992  254.47093 0.2565231</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      3691.712  0.71757408  5144.712  1453  351.33426 0.2417992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      3483.130  0.61440292  5669.130  2186  526.28787 0.2407538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      2864.498  0.43870111  6529.498  3665  941.32225 0.2568410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      1363.294  0.24853618  5485.294  4122 1175.94587 0.2852853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      344.014  0.07078457  4860.014  4516 1667.39240 0.3692189</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> total 30456.627  0.62742025 48542.627 18086 2702.70978 0.1494366</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compound Poisson GLM (variance function estimated from the data):</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu">glmReserve</span><span class="op">(</span><span class="va">GenIns</span>, var.power <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Latest Dev.To.Date  Ultimate  IBNR        S.E        CV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      5339.085  0.98269860  5433.085    94   91.59865 0.9744537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      4909.315  0.91330741  5375.315   466  186.54619 0.4003137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      4588.268  0.86779562  5287.268   699  223.72322 0.3200618</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      3873.311  0.79709058  4859.311   986  264.76238 0.2685217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      3691.712  0.72164188  5115.712  1424  333.24690 0.2340217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      3483.130  0.61505387  5663.130  2180  452.93426 0.2077680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      2864.498  0.42364843  6761.498  3897  754.58057 0.1936311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      1363.294  0.24230764  5626.294  4263 1019.45920 0.2391413</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      344.014  0.06942745  4955.014  4611 1910.99069 0.4144417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> total 30456.627  0.62058068 49077.627 18621 2831.45526 0.1520571</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now suppose we have an exposure measure</span></span></span>
<span class="r-in"><span><span class="co"># we can put it as an offset term in the model</span></span></span>
<span class="r-in"><span><span class="co"># to do this, use the "exposure" attribute of the 'triangle'</span></span></span>
<span class="r-in"><span><span class="va">expos</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">7</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> <span class="op">*</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">GenIns2</span> <span class="op">&lt;-</span> <span class="va">GenIns</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">GenIns2</span>, <span class="st">"exposure"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">expos</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">fit4</span> <span class="op">&lt;-</span> <span class="fu">glmReserve</span><span class="op">(</span><span class="va">GenIns2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Latest Dev.To.Date  Ultimate  IBNR       S.E        CV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      5339.085  0.98251776  5434.085    95  110.0999 1.1589460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      4909.315  0.91262828  5379.315   470  216.0434 0.4596668</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      4588.268  0.86599394  5298.268   710  260.8721 0.3674255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      3873.311  0.79725464  4858.311   985  303.5500 0.3081726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      3691.712  0.72234788  5110.712  1419  375.0139 0.2642804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      3483.130  0.61527116  5661.130  2178  495.3780 0.2274463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      2864.498  0.42221223  6784.498  3920  789.9611 0.2015207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      1363.294  0.24162052  5642.294  4279 1046.5138 0.2445697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      344.014  0.06921791  4970.014  4626 1980.1014 0.4280375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> total 30456.627  0.61982291 49137.627 18681 2945.6609 0.1576822</span>
<span class="r-in"><span><span class="co"># If the triangle's rownames are not convertible to numeric,</span></span></span>
<span class="r-in"><span><span class="co"># supply names to the exposures</span></span></span>
<span class="r-in"><span><span class="va">GenIns3</span> <span class="op">&lt;-</span> <span class="va">GenIns2</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">GenIns3</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fl">2007</span><span class="op">:</span><span class="fl">2016</span>, <span class="st">"-01-01"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">expos</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">GenIns3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">GenIns3</span>, <span class="st">"exposure"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">expos</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">fit4b</span> <span class="op">&lt;-</span> <span class="fu">glmReserve</span><span class="op">(</span><span class="va">GenIns3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Latest Dev.To.Date  Ultimate  IBNR       S.E        CV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2008-01-01  5339.085  0.98251776  5434.085    95  110.0999 1.1589460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2009-01-01  4909.315  0.91262828  5379.315   470  216.0434 0.4596668</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2010-01-01  4588.268  0.86599394  5298.268   710  260.8721 0.3674255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2011-01-01  3873.311  0.79725464  4858.311   985  303.5500 0.3081726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2012-01-01  3691.712  0.72234788  5110.712  1419  375.0139 0.2642804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2013-01-01  3483.130  0.61527116  5661.130  2178  495.3780 0.2274463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2014-01-01  2864.498  0.42221223  6784.498  3920  789.9611 0.2015207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2015-01-01  1363.294  0.24162052  5642.294  4279 1046.5138 0.2445697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2016-01-01   344.014  0.06921791  4970.014  4626 1980.1014 0.4280375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> total      30456.627  0.61982291 49137.627 18681 2945.6609 0.1576822</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use bootstrapping to compute prediction error</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">fit5</span> <span class="op">&lt;-</span> <span class="fu">glmReserve</span><span class="op">(</span><span class="va">GenIns</span>, mse.method <span class="op">=</span> <span class="st">"boot"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute the quantiles of the predicted loss reserves</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">fit5</span><span class="op">$</span><span class="va">sims.reserve.pred</span>, <span class="fl">2</span>, <span class="va">quantile</span>, </span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        </span></span>
<span class="r-in"><span><span class="co"># plot distribution of reserve</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit5</span>, which <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># alternative over-dispersed Poisson: negative binomial GLM</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">fit6</span> <span class="op">&lt;-</span> <span class="fu">glmReserve</span><span class="op">(</span><span class="va">GenIns</span>, nb <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Latest Dev.To.Date  Ultimate  IBNR        S.E        CV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      5339.085  0.98287950  5432.085    93   39.61362 0.4259529</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      4909.315  0.91654710  5356.315   447  133.65746 0.2990100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      4588.268  0.88197455  5202.268   614  148.48036 0.2418247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      3873.311  0.79594399  4866.311   993  211.05374 0.2125415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      3691.712  0.71771359  5143.712  1452  290.03379 0.1997478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      3483.130  0.61440292  5669.130  2186  433.04985 0.1981015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      2864.498  0.43836543  6534.498  3670  772.92403 0.2106060</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      1363.294  0.24826462  5491.294  4128  967.75982 0.2344379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      344.014  0.07075545  4862.014  4518 1380.13957 0.3054758</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> total 30456.627  0.62723935 48556.627 18100 2232.91773 0.1233656</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Markus Gesmann, Daniel Murphy, Yanwei (Wayne) Zhang, Alessandro Carrato, Mario Wuthrich, Fabio Concina, Eric Dal Moro.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

